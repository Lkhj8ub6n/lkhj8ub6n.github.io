<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operating System Concepts - Chapter 6: Deadlocks Complete Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.7;
            color: #333;
            background: linear-gradient(135deg, #28503e 0%, #deddeb 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            background: #ffffff;
            margin-top: 10px;
            margin-bottom: 10px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(40, 80, 62, 0.3);
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, #28503e 0%, #deddeb 100%);
            border-radius: 15px;
            margin-bottom: 20px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .nav-menu {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(40, 80, 62, 0.1);
        }

        .nav-btn {
            padding: 12px 18px;
            background: #28503e;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(40, 80, 62, 0.3);
            background: #deddeb;
            color: #28503e;
        }

        .nav-btn.active {
            background: #deddeb;
            color: #28503e;
            box-shadow: 0 5px 15px rgba(40, 80, 62, 0.2);
            transform: translateY(-2px);
        }

        .progress-container {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #28503e 0%, #deddeb 100%);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 15px;
            position: relative;
        }

        .progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .score-display {
            font-size: 1.4em;
            font-weight: bold;
            color: #28503e;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .achievements {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
        }

        .achievement {
            background: #28503e;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            opacity: 0.3;
            transition: all 0.3s ease;
        }

        .achievement.unlocked {
            opacity: 1;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .topic-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(40, 80, 62, 0.1);
            border-left: 5px solid #28503e;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .topic-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #28503e 0%, #deddeb 100%);
        }

        .topic-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(40, 80, 62, 0.15);
        }

        .topic-title {
            font-size: 2em;
            color: #28503e;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            font-weight: bold;
        }

        .topic-title::before {
            content: 'üîí';
            margin-right: 15px;
            font-size: 0.8em;
        }

        .highlight {
            background: linear-gradient(120deg, #fff3cd 0%, #ffeaa7 100%);
            padding: 6px 14px;
            border-radius: 8px;
            font-weight: bold;
            color: #28503e;
            border: 2px solid #f39c12;
            box-shadow: 0 2px 8px rgba(243, 156, 18, 0.3);
            display: inline-block;
            margin: 3px;
        }

        .highlight::before {
            content: '‚≠ê';
            margin-right: 8px;
        }

        .super-important {
            background: linear-gradient(120deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            padding: 10px 18px;
            border-radius: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            box-shadow: 0 4px 12px rgba(238, 90, 82, 0.4);
            display: inline-block;
            margin: 5px;
            animation: pulse 2s infinite;
        }

        .super-important::before {
            content: 'üî•';
            margin-right: 10px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .definition-box {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 3px solid #4caf50;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.2);
        }

        .definition-box::before {
            content: 'üìñ Important Definition';
            position: absolute;
            top: -15px;
            left: 25px;
            background: #4caf50;
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .key-concept {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 3px solid #2196f3;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            box-shadow: 0 8px 20px rgba(33, 150, 243, 0.2);
        }

        .key-concept::before {
            content: 'üîë Key Concept';
            position: absolute;
            top: -15px;
            left: 25px;
            background: #2196f3;
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .important-point {
            background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
            border: 3px solid #ff9800;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
            box-shadow: 0 6px 16px rgba(255, 152, 0, 0.3);
        }

        .important-point::before {
            content: 'üí°';
            position: absolute;
            top: -12px;
            left: 20px;
            background: #ff9800;
            color: white;
            padding: 8px 12px;
            border-radius: 50%;
            font-size: 1.2em;
        }

        .memory-tip {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            border: 3px solid #9c27b0;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
            box-shadow: 0 6px 16px rgba(156, 39, 176, 0.3);
        }

        .memory-tip::before {
            content: 'üß† Memory Tip';
            position: absolute;
            top: -15px;
            left: 20px;
            background: #9c27b0;
            color: white;
            padding: 6px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .deadlock-diagram {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 3px solid #28503e;
            border-radius: 15px;
            padding: 30px;
            margin: 25px 0;
            text-align: center;
            box-shadow: 0 8px 20px rgba(40, 80, 62, 0.1);
        }

        .resource-graph {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .process-node {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 3px solid #2196f3;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1976d2;
            font-size: 1.1em;
        }

        .resource-node {
            width: 90px;
            height: 70px;
            background: linear-gradient(135deg, #fff3e0 0%, #ffcc02 100%);
            border: 3px solid #ff9800;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #f57c00;
            font-size: 1.1em;
        }

        .arrow {
            width: 50px;
            height: 3px;
            background: #28503e;
            position: relative;
            margin: 0 15px;
        }

        .arrow::after {
            content: '';
            position: absolute;
            right: -8px;
            top: -5px;
            width: 0;
            height: 0;
            border-left: 12px solid #28503e;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
        }

        .deadlock-conditions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .condition-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 25px;
            border-radius: 15px;
            border: 3px solid #28503e;
            text-align: center;
            position: relative;
            box-shadow: 0 6px 15px rgba(40, 80, 62, 0.1);
            transition: all 0.3s ease;
        }

        .condition-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(40, 80, 62, 0.15);
        }

        .condition-card h4 {
            color: #28503e;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .quiz-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border: 3px solid #28503e;
            position: relative;
        }

        .quiz-section::before {
            content: 'üéØ Quiz Time';
            position: absolute;
            top: -18px;
            left: 25px;
            background: #28503e;
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: bold;
        }

        .quiz-container {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 6px 18px rgba(40, 80, 62, 0.1);
            transition: all 0.3s ease;
        }

        .quiz-container:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(40, 80, 62, 0.15);
        }

        .question {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #28503e;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .question-type {
            background: #28503e;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.7em;
            margin-right: 15px;
            margin-bottom: 8px;
        }

        .options {
            display: grid;
            gap: 12px;
            margin-bottom: 20px;
        }

        .option {
            padding: 15px 25px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
            font-size: 1.05em;
        }

        .option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(40, 80, 62, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .option:hover::before {
            left: 100%;
        }

        .option:hover {
            border-color: #28503e;
            transform: translateX(8px);
            box-shadow: 0 6px 18px rgba(40, 80, 62, 0.1);
        }

        .option.selected {
            border-color: #28503e;
            background: #f8f9fa;
        }

        .option.correct {
            border-color: #4caf50;
            background: #e8f5e8;
            animation: correctPulse 0.5s ease;
        }

        .option.incorrect {
            border-color: #f44336;
            background: #ffebee;
            animation: incorrectShake 0.5s ease;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .true-false {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tf-option {
            flex: 1;
            max-width: 220px;
            min-width: 140px;
            padding: 18px;
            text-align: center;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .tf-true {
            background: #e8f5e8;
            border: 3px solid #4caf50;
            color: #2e7d32;
        }

        .tf-false {
            background: #ffebee;
            border: 3px solid #f44336;
            color: #c62828;
        }

        .tf-option:hover {
            transform: scale(1.08);
        }

        .tf-option.selected {
            box-shadow: 0 0 25px rgba(40, 80, 62, 0.4);
        }

        .fill-blank {
            background: #f8f9fa;
            border: 3px dashed #28503e;
            border-radius: 8px;
            padding: 12px;
            margin: 0 8px;
            min-width: 120px;
            display: inline-block;
            text-align: center;
        }

        .fill-blank input {
            border: none;
            background: transparent;
            text-align: center;
            font-weight: bold;
            color: #28503e;
            width: 100%;
            font-size: 1.1em;
        }

        .result {
            padding: 18px;
            border-radius: 12px;
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
            opacity: 0;
            transform: translateY(15px);
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .result.show {
            opacity: 1;
            transform: translateY(0);
        }

        .result.correct {
            background: #e8f5e8;
            color: #2e7d32;
            border: 3px solid #4caf50;
        }

        .result.incorrect {
            background: #ffebee;
            color: #c62828;
            border: 3px solid #f44336;
        }

        .quiz-btn {
            background: #28503e;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 8px;
            position: relative;
            overflow: hidden;
            font-weight: bold;
        }

        .quiz-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
        }

        .quiz-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .quiz-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(40, 80, 62, 0.3);
            background: #deddeb;
            color: #28503e;
        }

        .key-points {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid #28503e;
            box-shadow: 0 6px 15px rgba(40, 80, 62, 0.1);
        }

        .key-points h4 {
            color: #28503e;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .key-points ul {
            list-style: none;
            padding-left: 0;
        }

        .key-points li {
            margin: 15px 0;
            position: relative;
            padding-left: 40px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(40, 80, 62, 0.1);
        }

        .key-points li::before {
            content: '‚úÖ';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
        }

        .summary-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 18px;
            margin: 25px 0;
            border: 3px solid #28503e;
            box-shadow: 0 10px 25px rgba(40, 80, 62, 0.1);
        }

        .collapsible {
            cursor: pointer;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            margin: 20px 0;
            transition: all 0.3s ease;
            border: 3px solid #28503e;
            position: relative;
            box-shadow: 0 6px 15px rgba(40, 80, 62, 0.1);
            font-weight: bold;
            font-size: 1.1em;
        }

        .collapsible::after {
            content: '‚ñº';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            transition: transform 0.3s ease;
            font-size: 1.3em;
            color: #28503e;
        }

        .collapsible.active::after {
            transform: translateY(-50%) rotate(180deg);
        }

        .collapsible:hover {
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(40, 80, 62, 0.15);
        }

        .collapsible-content {
            display: none;
            padding: 25px;
            border-top: 3px solid #28503e;
            background: white;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 6px 15px rgba(40, 80, 62, 0.1);
        }

        .collapsible.active + .collapsible-content {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 800px; }
        }

        .important {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 3px solid #f39c12;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            box-shadow: 0 8px 20px rgba(243, 156, 18, 0.3);
        }

        .important::before {
            content: '‚ö†Ô∏è Important';
            position: absolute;
            top: -15px;
            left: 25px;
            background: #f39c12;
            color: white;
            padding: 6px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .stats-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 25px;
            border-radius: 18px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(40, 80, 62, 0.1);
            border: 3px solid #28503e;
        }

        .stats-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #28503e;
        }

        .stats-label {
            color: #666;
            margin-top: 10px;
            font-weight: 600;
            font-size: 1.1em;
        }

        .quiz-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .visual-separator {
            height: 5px;
            background: linear-gradient(90deg, transparent 0%, #28503e 20%, #deddeb 50%, #28503e 80%, transparent 100%);
            margin: 30px 0;
            border-radius: 3px;
            position: relative;
        }

        .visual-separator::before {
            content: '';
            position: absolute;
            top: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 10px;
            background: #28503e;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(40, 80, 62, 0.5);
        }

        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, transparent 0%, #28503e 50%, transparent 100%);
            margin: 25px 0;
            border-radius: 2px;
        }

        .concept-highlight {
            background: linear-gradient(120deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 25px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            display: inline-block;
            margin: 3px;
        }

        .exam-tip {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid #e84393;
            box-shadow: 0 8px 20px rgba(232, 67, 147, 0.3);
            position: relative;
        }

        .exam-tip::before {
            content: 'üìù Exam Tip';
            position: absolute;
            top: -15px;
            left: 20px;
            background: #e84393;
            color: white;
            padding: 6px 15px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .algorithm-box {
            background: linear-gradient(135deg, #e8f4fd 0%, #d1ecf1 100%);
            border: 3px solid #17a2b8;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            box-shadow: 0 8px 20px rgba(23, 162, 184, 0.2);
        }

        .algorithm-box::before {
            content: '‚öôÔ∏è Algorithm';
            position: absolute;
            top: -15px;
            left: 25px;
            background: #17a2b8;
            color: white;
            padding: 6px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            border-left: 4px solid #28503e;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            box-shadow: 0 8px 20px rgba(40, 80, 62, 0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .comparison-table th {
            background: #28503e;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
        }

        .comparison-table td {
            padding: 15px;
            border: 1px solid #ddd;
            text-align: center;
            background: white;
        }

        .comparison-table tr:nth-child(even) td {
            background: #f8f9fa;
        }

        .comparison-table tr:hover td {
            background: #e8f4fd;
        }

        /* Enhanced mobile responsiveness */
        @media (max-width: 768px) {
            .container {
                margin: 5px;
                padding: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .nav-menu {
                gap: 5px;
                padding: 10px;
            }
            
            .nav-btn {
                padding: 10px 14px;
                font-size: 12px;
            }

            .topic-title {
                font-size: 1.6em;
            }

            .quiz-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .deadlock-conditions {
                grid-template-columns: 1fr;
            }

            .resource-graph {
                flex-direction: column;
            }

            .arrow {
                transform: rotate(90deg);
                margin: 15px 0;
            }

            .comparison-table {
                font-size: 0.9em;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 10px 8px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.6em;
            }

            .quiz-stats {
                grid-template-columns: 1fr;
            }

            .stats-number {
                font-size: 2em;
            }

            .true-false {
                flex-direction: column;
            }

            .comparison-table {
                font-size: 0.8em;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 8px 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Chapter 6: Deadlocks</h1>
            <p>Complete Interactive Guide with Comprehensive Explanations</p>
        </header>

        <nav class="nav-menu">
            <button class="nav-btn active" data-section="overview">Overview</button>
            <button class="nav-btn" data-section="deadlock-problem">Deadlock Problem</button>
            <button class="nav-btn" data-section="characterization">Characterization</button>
            <button class="nav-btn" data-section="resource-graph">Resource Graph</button>
            <button class="nav-btn" data-section="prevention">Prevention</button>
            <button class="nav-btn" data-section="avoidance">Avoidance</button>
            <button class="nav-btn" data-section="detection">Detection</button>
            <button class="nav-btn" data-section="recovery">Recovery</button>
            <button class="nav-btn" data-section="methods-comparison">Methods Comparison</button>
            <button class="nav-btn" data-section="comprehensive-quiz">Final Exam</button>
            <button class="nav-btn" data-section="final-summary">Summary</button>
        </nav>

        <div class="progress-container">
            <div class="score-display">
                <span id="scoreDisplay">Score: 0/0</span>
                <span id="percentageDisplay">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <div class="achievements" id="achievements">
                <div class="achievement" data-unlock="5">üåü First Steps</div>
                <div class="achievement" data-unlock="15">üéØ Getting Started</div>
                <div class="achievement" data-unlock="30">üöÄ Knowledge Builder</div>
                <div class="achievement" data-unlock="50">üèÜ Expert Level</div>
                <div class="achievement" data-unlock="75">üíé Master</div>
                <div class="achievement" data-unlock="100">üëë Deadlock Expert</div>
            </div>
        </div>

        <!-- Overview Section -->
        <div id="overview" class="section active">
            <div class="topic-card">
                <h2 class="topic-title">Chapter 6: Deadlocks - Complete Overview</h2>
                
                <div class="definition-box">
                    <h3>üìö Complete Chapter Contents</h3>
                    <div class="key-points">
                        <ul>
                            <li><span class="highlight">The Deadlock Problem</span> - Understanding what deadlock is and why it occurs</li>
                            <li><span class="highlight">Deadlock Characterization</span> - Four necessary conditions for deadlock</li>
                            <li><span class="highlight">Resource-Allocation Graph</span> - Visual representation and analysis</li>
                            <li><span class="highlight">Methods for Handling Deadlocks</span> - Four main approaches</li>
                            <li><span class="highlight">Deadlock Prevention</span> - Ensuring conditions cannot hold</li>
                            <li><span class="highlight">Deadlock Avoidance</span> - Safe state and Banker's algorithm</li>
                            <li><span class="highlight">Deadlock Detection</span> - Finding deadlocks when they occur</li>
                            <li><span class="highlight">Recovery from Deadlock</span> - Dealing with detected deadlocks</li>
                        </ul>
                    </div>
                </div>

                <div class="visual-separator"></div>

                <div class="key-concept">
                    <h3>üéØ Learning Objectives</h3>
                    <div class="key-points">
                        <ul>
                            <li><span class="super-important">Master the concept of deadlock and its four necessary conditions</span></li>
                            <li><span class="highlight">Learn to draw and analyze resource allocation graphs</span></li>
                            <li><span class="highlight">Understand all deadlock handling methods: Prevention, Avoidance, Detection, Ignore</span></li>
                            <li><span class="highlight">Master Banker's algorithm for deadlock avoidance</span></li>
                            <li><span class="highlight">Learn deadlock detection algorithms for single and multiple instances</span></li>
                            <li><span class="highlight">Understand recovery strategies: process termination and resource preemption</span></li>
                            <li><span class="highlight">Compare different approaches and know when to use each</span></li>
                        </ul>
                    </div>
                </div>

                <div class="important-point">
                    <h4>üîç Why Study Deadlocks?</h4>
                    <p><strong>Deadlocks are one of the most critical issues in operating systems.</strong> They can cause the entire system to freeze, making it essential for system designers and programmers to understand:</p>
                    <ul style="margin-top: 15px; padding-left: 20px;">
                        <li>How deadlocks occur in real systems</li>
                        <li>How to prevent them from happening</li>
                        <li>How to detect them when they occur</li>
                        <li>How to recover from them efficiently</li>
                        <li>Trade-offs between different handling approaches</li>
                    </ul>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Master Strategy:</strong> Think of deadlock as a traffic jam where each car needs the space occupied by another car to move forward - nobody can proceed! This analogy will help you understand all deadlock concepts.</p>
                </div>

                <div class="quiz-stats">
                    <div class="stats-card">
                        <div class="stats-number" id="totalQuestions">0</div>
                        <div class="stats-label">Total Questions</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-number" id="correctAnswers">0</div>
                        <div class="stats-label">Correct Answers</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-number" id="accuracy">0%</div>
                        <div class="stats-label">Accuracy Rate</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-number" id="sectionsCompleted">0</div>
                        <div class="stats-label">Sections Completed</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deadlock Problem Section -->
        <div id="deadlock-problem" class="section">
            <div class="topic-card">
                <h2 class="topic-title">The Deadlock Problem</h2>
                
                <div class="definition-box">
                    <h3>üîç Complete Definition of Deadlock</h3>
                    <p class="super-important">A set of blocked processes each holding a resource and waiting to acquire a resource held by another process in the set.</p>
                    <p><strong>Key characteristics:</strong></p>
                    <ul style="margin-top: 15px; padding-left: 25px;">
                        <li>All processes are <strong>blocked</strong> (cannot proceed)</li>
                        <li>Each process <strong>holds</strong> at least one resource</li>
                        <li>Each process is <strong>waiting</strong> for another resource</li>
                        <li>The resources they're waiting for are held by <strong>other processes in the set</strong></li>
                        <li>This creates a <strong>circular dependency</strong></li>
                    </ul>
                </div>

                <div class="deadlock-diagram">
                    <h4>üîÑ Classic Deadlock Example</h4>
                    <div class="resource-graph">
                        <div class="process-node">P1</div>
                        <div class="arrow"></div>
                        <div class="resource-node">R2</div>
                        <div class="arrow"></div>
                        <div class="process-node">P2</div>
                        <div class="arrow"></div>
                        <div class="resource-node">R1</div>
                        <div class="arrow"></div>
                        <div class="process-node">P1</div>
                    </div>
                    <p><strong>Circular Dependency:</strong> P1 holds R1 and wants R2, P2 holds R2 and wants R1</p>
                    <p><strong>Result:</strong> Both processes are permanently blocked!</p>
                </div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üìñ Comprehensive Real-World Examples
                </div>
                <div class="collapsible-content">
                    <div class="important-point">
                        <h4>üöó Traffic Bridge Example (Classic)</h4>
                        <p><strong>Scenario:</strong> Single-lane bridge with traffic from both directions</p>
                        <ul>
                            <li><span class="highlight">Bridge sections are resources</span></li>
                            <li><span class="highlight">Cars are processes</span></li>
                            <li><span class="highlight">Each car holds one section and needs the next</span></li>
                            <li><span class="highlight">When cars meet in the middle: DEADLOCK!</span></li>
                        </ul>
                        <p><strong>Solutions:</strong> Traffic lights (prevention), traffic controller (avoidance), or backing up (recovery)</p>
                    </div>

                    <div class="important-point">
                        <h4>üñ®Ô∏è System Resources Example</h4>
                        <p><strong>Scenario:</strong> System has 2 tape drives</p>
                        <div class="code-block">
Process A: Requests drive 1 ‚Üí Gets it ‚Üí Requests drive 2 ‚Üí BLOCKED
Process B: Requests drive 2 ‚Üí Gets it ‚Üí Requests drive 1 ‚Üí BLOCKED
Result: DEADLOCK - Neither can proceed
                        </div>
                    </div>

                    <div class="important-point">
                        <h4>üíæ Database Deadlock Example</h4>
                        <p><strong>Scenario:</strong> Two transactions accessing database records</p>
                        <div class="code-block">
Transaction T1: Lock Record A ‚Üí Try to lock Record B ‚Üí WAIT
Transaction T2: Lock Record B ‚Üí Try to lock Record A ‚Üí WAIT
Result: Both transactions wait forever - DEADLOCK!
                        </div>
                    </div>

                    <div class="important-point">
                        <h4>üîß Dining Philosophers Problem</h4>
                        <p><strong>Scenario:</strong> 5 philosophers, 5 chopsticks (shared between adjacent philosophers)</p>
                        <ul>
                            <li>Each philosopher needs 2 chopsticks to eat</li>
                            <li>If all pick up left chopstick simultaneously</li>
                            <li>All wait for right chopstick forever</li>
                            <li>Classic deadlock demonstration!</li>
                        </ul>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="important">
                    <h4>‚öôÔ∏è Semaphore Deadlock Example (Code Level)</h4>
                    <div class="deadlock-diagram">
                        <h5>Semaphores A and B, both initialized to 1</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin: 20px 0;">
                            <div class="code-block">
<strong>Process P0:</strong>
wait(A);        // Gets A
wait(B);        // Waits for B
// Critical section
signal(B);
signal(A);
                            </div>
                            <div class="code-block">
<strong>Process P1:</strong>
wait(B);        // Gets B
wait(A);        // Waits for A
// Critical section
signal(A);
signal(B);
                            </div>
                        </div>
                        <p><strong>Timeline leading to deadlock:</strong></p>
                        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <strong>T1:</strong> P0 executes wait(A) ‚Üí P0 gets semaphore A<br>
                            <strong>T2:</strong> P1 executes wait(B) ‚Üí P1 gets semaphore B<br>
                            <strong>T3:</strong> P0 executes wait(B) ‚Üí P0 blocked (B held by P1)<br>
                            <strong>T4:</strong> P1 executes wait(A) ‚Üí P1 blocked (A held by P0)<br>
                            <strong>Result:</strong> DEADLOCK! Both processes permanently blocked.
                        </div>
                    </div>
                </div>

                <div class="algorithm-box">
                    <h4>üîç Characteristics of Deadlock Situations</h4>
                    <ol style="padding-left: 25px; line-height: 2;">
                        <li><strong>Mutual Dependency:</strong> Processes depend on each other for resources</li>
                        <li><strong>Circular Wait:</strong> Forms a closed loop of dependencies</li>
                        <li><strong>Permanent Blocking:</strong> No process can make progress</li>
                        <li><strong>Resource Scarcity:</strong> Limited resources relative to demand</li>
                        <li><strong>No Preemption:</strong> Resources cannot be forcibly taken</li>
                    </ol>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Exam Focus:</strong> Be able to identify deadlock scenarios, explain why they occur, and distinguish deadlock from other blocking situations like starvation or simple waiting.</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 1: What is the most accurate definition of deadlock?
                        </div>
                        <div class="options" data-question="1">
                            <div class="option" data-answer="wrong">A) When a process runs very slowly due to limited CPU</div>
                            <div class="option" data-answer="correct">B) A set of blocked processes each holding a resource and waiting for another</div>
                            <div class="option" data-answer="wrong">C) When the system runs out of memory</div>
                            <div class="option" data-answer="wrong">D) A scheduling algorithm that prioritizes certain processes</div>
                        </div>
                        <div class="result" id="result1"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 2: In the semaphore example, deadlock occurs when P0 gets A and P1 gets B simultaneously, then each tries to get the other's semaphore.
                        </div>
                        <div class="true-false" data-question="2">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result2"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 3: In the dining philosophers problem, deadlock occurs when:
                        </div>
                        <div class="options" data-question="3">
                            <div class="option" data-answer="wrong">A) One philosopher eats too much</div>
                            <div class="option" data-answer="correct">B) All philosophers pick up their left chopstick simultaneously</div>
                            <div class="option" data-answer="wrong">C) Philosophers eat in random order</div>
                            <div class="option" data-answer="wrong">D) There are more philosophers than chopsticks</div>
                        </div>
                        <div class="result" id="result3"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 4: In a deadlock, each process is <span class="fill-blank"><input type="text" data-answer="waiting" placeholder="?"></span> for a resource held by another process in the set.
                        </div>
                        <div class="result" id="result4"></div>
                        <button class="quiz-btn" data-check="4">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deadlock Characterization Section -->
        <div id="characterization" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Deadlock Characterization</h2>
                
                <div class="key-concept">
                    <h3>üîë The Four Necessary Conditions for Deadlock</h3>
                    <p class="super-important">Deadlock can arise if and only if ALL FOUR conditions hold simultaneously.</p>
                    <p><strong>Critical Point:</strong> All four conditions are NECESSARY. If any one is absent, deadlock CANNOT occur.</p>
                </div>

                <div class="deadlock-conditions">
                    <div class="condition-card">
                        <h4>üîí 1. Mutual Exclusion</h4>
                        <p><span class="highlight">Only one process at a time can use a resource</span></p>
                        <p><strong>Details:</strong></p>
                        <ul style="text-align: left; margin-top: 10px;">
                            <li>At least one resource must be held in a non-sharable mode</li>
                            <li>If another process requests that resource, it must be delayed</li>
                            <li>Only the holding process can release the resource</li>
                        </ul>
                    </div>
                    
                    <div class="condition-card">
                        <h4>‚úã 2. Hold and Wait</h4>
                        <p><span class="highlight">A process holding at least one resource is waiting to acquire additional resources</span></p>
                        <p><strong>Details:</strong></p>
                        <ul style="text-align: left; margin-top: 10px;">
                            <li>Process must hold at least one resource</li>
                            <li>Process must be waiting for additional resources</li>
                            <li>Those additional resources are currently held by other processes</li>
                        </ul>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üö´ 3. No Preemption</h4>
                        <p><span class="highlight">A resource can be released only voluntarily by the process holding it</span></p>
                        <p><strong>Details:</strong></p>
                        <ul style="text-align: left; margin-top: 10px;">
                            <li>Resources cannot be forcibly removed from processes</li>
                            <li>Process must complete its task and release voluntarily</li>
                            <li>OS cannot reclaim resources from waiting processes</li>
                        </ul>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üîÑ 4. Circular Wait</h4>
                        <p><span class="highlight">There exists a set of waiting processes forming a circular chain</span></p>
                        <p><strong>Details:</strong></p>
                        <ul style="text-align: left; margin-top: 10px;">
                            <li>P0 is waiting for resource held by P1</li>
                            <li>P1 is waiting for resource held by P2</li>
                            <li>...Pn is waiting for resource held by P0</li>
                        </ul>
                    </div>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Memory Technique:</strong> <strong>MHNC</strong> - <strong>M</strong>utual exclusion, <strong>H</strong>old and wait, <strong>N</strong>o preemption, <strong>C</strong>ircular wait</p>
                    <p><strong>Alternative:</strong> "Must Have No Cycles" - but only when all conditions present!</p>
                </div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üìñ Detailed Analysis of Each Condition
                </div>
                <div class="collapsible-content">
                    <div class="important-point">
                        <h4>üîí Mutual Exclusion - Deep Dive</h4>
                        <p><strong>When it applies:</strong></p>
                        <ul>
                            <li><span class="highlight">Printers, tape drives, database locks</span></li>
                            <li><span class="highlight">Critical sections protected by semaphores</span></li>
                            <li><span class="highlight">Any non-sharable resource</span></li>
                        </ul>
                        <p><strong>When it doesn't apply:</strong></p>
                        <ul>
                            <li><span class="concept-highlight">Read-only files (multiple readers allowed)</span></li>
                            <li><span class="concept-highlight">Sharable memory segments</span></li>
                            <li><span class="concept-highlight">CPU time (can be time-shared)</span></li>
                        </ul>
                        <div class="exam-tip">
                            <p><strong>Exam Note:</strong> Mutual exclusion is usually NOT preventable for non-sharable resources, making it an impractical target for deadlock prevention.</p>
                        </div>
                    </div>

                    <div class="important-point">
                        <h4>‚úã Hold and Wait - Deep Dive</h4>
                        <p><strong>Examples in real systems:</strong></p>
                        <div class="code-block">
// Example 1: File processing
open_file("input.txt");        // Hold file resource
request_memory(1024);          // Wait for memory
process_data();
close_file("input.txt");

// Example 2: Database transaction
begin_transaction();
lock_table("accounts");        // Hold table lock
request_lock("audit_log");     // Wait for another lock
update_records();
commit_transaction();
                        </div>
                        <p><strong>Why it's problematic:</strong></p>
                        <ul>
                            <li>Creates dependencies between processes</li>
                            <li>Increases probability of circular dependencies</li>
                            <li>Resources may be held for extended periods</li>
                        </ul>
                    </div>

                    <div class="important-point">
                        <h4>üö´ No Preemption - Deep Dive</h4>
                        <p><strong>Resources that can be preempted:</strong></p>
                        <ul>
                            <li><span class="concept-highlight">CPU (through scheduling)</span></li>
                            <li><span class="concept-highlight">Memory (through swapping)</span></li>
                            <li><span class="concept-highlight">Some I/O operations</span></li>
                        </ul>
                        <p><strong>Resources that cannot be easily preempted:</strong></p>
                        <ul>
                            <li><span class="highlight">Printer in the middle of printing</span></li>
                            <li><span class="highlight">Database locks during transactions</span></li>
                            <li><span class="highlight">Tape drive during write operations</span></li>
                        </ul>
                        <div class="important">
                            <p><strong>‚ö†Ô∏è Preemption Issues:</strong> Preempting certain resources can lead to inconsistent states or data corruption, making this approach difficult to implement safely.</p>
                        </div>
                    </div>

                    <div class="important-point">
                        <h4>üîÑ Circular Wait - Deep Dive</h4>
                        <p><strong>Mathematical representation:</strong></p>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            Let {P‚ÇÄ, P‚ÇÅ, ..., P‚Çô} be the set of processes in the circular wait.<br>
                            P‚ÇÄ is waiting for a resource held by P‚ÇÅ<br>
                            P‚ÇÅ is waiting for a resource held by P‚ÇÇ<br>
                            ...<br>
                            P‚Çô is waiting for a resource held by P‚ÇÄ
                        </div>
                        <p><strong>Detection method:</strong></p>
                        <ul>
                            <li>Construct a wait-for graph</li>
                            <li>Check for cycles in the graph</li>
                            <li>Cycle = Circular wait condition</li>
                        </ul>
                    </div>
                </div>

                <div class="algorithm-box">
                    <h4>üßÆ Logical Relationship Between Conditions</h4>
                    <p><strong>Important logical facts:</strong></p>
                    <ul style="line-height: 2;">
                        <li><span class="super-important">ALL four conditions are NECESSARY for deadlock</span></li>
                        <li><span class="highlight">If ANY condition is absent ‚Üí NO deadlock possible</span></li>
                        <li><span class="highlight">If ALL conditions present ‚Üí Deadlock MAY occur (not guaranteed)</span></li>
                        <li><span class="concept-highlight">Circular wait implies hold and wait</span></li>
                        <li><span class="concept-highlight">But hold and wait doesn't imply circular wait</span></li>
                    </ul>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Critical Exam Points:</strong></p>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Know all four conditions by heart and in order</li>
                        <li>Understand that ALL must be present simultaneously</li>
                        <li>Be able to identify which condition is violated in prevention methods</li>
                        <li>Distinguish between necessary and sufficient conditions</li>
                    </ul>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 5: How many conditions must hold simultaneously for deadlock to occur?
                        </div>
                        <div class="options" data-question="5">
                            <div class="option" data-answer="wrong">A) At least 2</div>
                            <div class="option" data-answer="wrong">B) At least 3</div>
                            <div class="option" data-answer="correct">C) All 4</div>
                            <div class="option" data-answer="wrong">D) Any 3 out of 4</div>
                        </div>
                        <div class="result" id="result5"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 6: Which condition means "only one process can use a resource at a time"?
                        </div>
                        <div class="options" data-question="6">
                            <div class="option" data-answer="correct">A) Mutual Exclusion</div>
                            <div class="option" data-answer="wrong">B) Hold and Wait</div>
                            <div class="option" data-answer="wrong">C) No Preemption</div>
                            <div class="option" data-answer="wrong">D) Circular Wait</div>
                        </div>
                        <div class="result" id="result6"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 7: If any one of the four conditions is absent, deadlock cannot occur.
                        </div>
                        <div class="true-false" data-question="7">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result7"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 8: The condition where resources cannot be forcibly taken away is called <span class="fill-blank"><input type="text" data-answer="no preemption" placeholder="?"></span>.
                        </div>
                        <div class="result" id="result8"></div>
                        <button class="quiz-btn" data-check="8">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resource Allocation Graph Section -->
        <div id="resource-graph" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Resource-Allocation Graph</h2>
                
                <div class="definition-box">
                    <h3>üìä Resource Allocation Graph (RAG)</h3>
                    <p class="super-important">A directed graph that provides a visual representation of resource allocation state in the system and helps in deadlock detection.</p>
                    <p><strong>Formal Definition:</strong> G = (V, E) where V is a set of vertices and E is a set of edges.</p>
                </div>

                <div class="key-concept">
                    <h4>üîó Complete Graph Components</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin: 20px 0;">
                        <div>
                            <h5><strong>Vertices (V) consist of:</strong></h5>
                            <ul style="line-height: 2;">
                                <li><span class="highlight">P = {P‚ÇÅ, P‚ÇÇ, ..., P‚Çô}</span> - Set of all processes</li>
                                <li><span class="highlight">R = {R‚ÇÅ, R‚ÇÇ, ..., R‚Çò}</span> - Set of all resource types</li>
                            </ul>
                            
                            <h5><strong>Edges (E) consist of:</strong></h5>
                            <ul style="line-height: 2;">
                                <li><span class="highlight">Request edge: P·µ¢ ‚Üí R‚±º</span> (process requests resource)</li>
                                <li><span class="highlight">Assignment edge: R‚±º ‚Üí P·µ¢</span> (resource allocated to process)</li>
                                <li><span class="concept-highlight">Claim edge: P·µ¢ ‚á¢ R‚±º</span> (dashed line - future request)</li>
                            </ul>
                        </div>
                        <div>
                            <h5><strong>Resource Instances:</strong></h5>
                            <ul style="line-height: 2;">
                                <li>Each resource type R‚±º has W‚±º instances</li>
                                <li>Represented as dots inside resource rectangles</li>
                                <li>Assignment edges point from specific instances</li>
                                <li>Request edges point to the resource type</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="deadlock-diagram">
                    <h4>üé® Complete Graph Symbol Guide</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="text-align: center; padding: 15px; border: 2px solid #28503e; border-radius: 10px;">
                            <div class="process-node" style="margin: 0 auto;">Pi</div>
                            <p style="margin-top: 10px;"><strong>Process</strong><br>Circular node</p>
                        </div>
                        
                        <div style="text-align: center; padding: 15px; border: 2px solid #28503e; border-radius: 10px;">
                            <div class="resource-node" style="margin: 0 auto;">Rj</div>
                            <p style="margin-top: 10px;"><strong>Resource Type</strong><br>Rectangular node</p>
                        </div>
                        
                        <div style="text-align: center; padding: 15px; border: 2px solid #28503e; border-radius: 10px;">
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">Pi</div>
                                <div class="arrow" style="width: 30px;"></div>
                                <div class="resource-node" style="width: 60px; height: 50px; font-size: 0.9em;">Rj</div>
                            </div>
                            <p style="margin-top: 10px;"><strong>Request Edge</strong><br>Pi requests Rj</p>
                        </div>
                        
                        <div style="text-align: center; padding: 15px; border: 2px solid #28503e; border-radius: 10px;">
                            <div style="display: flex; align-items: center; justify-content: center;">
                                <div class="resource-node" style="width: 60px; height: 50px; font-size: 0.9em;">Rj</div>
                                <div class="arrow" style="width: 30px;"></div>
                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">Pi</div>
                            </div>
                            <p style="margin-top: 10px;"><strong>Assignment Edge</strong><br>Rj assigned to Pi</p>
                        </div>
                    </div>
                </div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üìä Fundamental Facts about Resource Allocation Graphs
                </div>
                <div class="collapsible-content">
                    <div class="important">
                        <h4>üìã Critical RAG Principles:</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h5><strong>üîç Cycle Detection Rules:</strong></h5>
                                <ul style="line-height: 2;">
                                    <li><span class="super-important">No cycles ‚áí No deadlock</span></li>
                                    <li><span class="super-important">Cycle exists ‚áí Depends on instances:</span>
                                        <ul style="margin-left: 20px; margin-top: 10px;">
                                            <li><span class="highlight">Single instance per type ‚Üí Deadlock</span></li>
                                            <li><span class="highlight">Multiple instances ‚Üí Possibly deadlock</span></li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <h5><strong>üéØ Graph Construction Steps:</strong></h5>
                                <ol style="line-height: 2;">
                                    <li>Draw all processes as circles</li>
                                    <li>Draw all resource types as rectangles</li>
                                    <li>Add dots for resource instances</li>
                                    <li>Draw request edges (P ‚Üí R)</li>
                                    <li>Draw assignment edges (R ‚Üí P)</li>
                                    <li>Check for cycles</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div class="algorithm-box">
                        <h4>üîç Cycle Detection Algorithm</h4>
                        <div class="code-block">
Algorithm: Detect_Cycle_In_RAG(Graph G)
Input: Resource Allocation Graph G = (V, E)
Output: True if cycle exists, False otherwise

1. Initialize: visited[] = false for all vertices
2. Initialize: recursion_stack[] = false for all vertices
3. For each vertex v in V:
   4. If not visited[v]:
      5. If DFS_Has_Cycle(v, visited, recursion_stack):
         6. Return True
7. Return False

DFS_Has_Cycle(vertex v, visited[], recursion_stack[]):
1. visited[v] = true
2. recursion_stack[v] = true
3. For each adjacent vertex u of v:
   4. If not visited[u]:
      5. If DFS_Has_Cycle(u, visited, recursion_stack):
         6. Return True
   7. Else if recursion_stack[u]:
      8. Return True
9. recursion_stack[v] = false
10. Return False
                        </div>
                        <p><strong>Time Complexity:</strong> O(V + E) where V is vertices and E is edges</p>
                    </div>

                    <div class="important-point">
                        <h4>üìà Example: Single vs Multiple Instances</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="background: #ffebee; padding: 15px; border-radius: 10px; border: 2px solid #f44336;">
                                <h6 style="color: #c62828;"><strong>Single Instance - Deadlock Certain</strong></h6>
                                <div style="margin: 15px 0;">
                                    <div class="resource-graph" style="justify-content: center; margin: 10px 0;">
                                        <div class="process-node" style="width: 40px; height: 40px; font-size: 0.8em;">P1</div>
                                        <div class="arrow" style="width: 25px;"></div>
                                        <div class="resource-node" style="width: 40px; height: 30px; font-size: 0.7em;">R1</div>
                                        <div class="arrow" style="width: 25px;"></div>
                                        <div class="process-node" style="width: 40px; height: 40px; font-size: 0.8em;">P2</div>
                                        <div class="arrow" style="width: 25px;"></div>
                                        <div class="resource-node" style="width: 40px; height: 30px; font-size: 0.7em;">R2</div>
                                        <div class="arrow" style="width: 25px;"></div>
                                        <div class="process-node" style="width: 40px; height: 40px; font-size: 0.8em;">P1</div>
                                    </div>
                                </div>
                                <p>P1 ‚Üí R1 ‚Üí P2 ‚Üí R2 ‚Üí P1 forms a cycle</p>
                                <p><strong>Result:</strong> Definite deadlock!</p>
                            </div>
                            <div style="background: #fff3e0; padding: 15px; border-radius: 10px; border: 2px solid #ff9800;">
                                <h6 style="color: #f57c00;"><strong>Multiple Instances - Maybe Deadlock</strong></h6>
                                <p style="margin: 10px 0;">If R1 has 2 instances and only one is allocated:</p>
                                <ul style="line-height: 1.8;">
                                    <li>P2 might finish and release R2</li>
                                    <li>Then P1 can get R2 and finish</li>
                                    <li>Or P3 might get the free R1 instance</li>
                                </ul>
                                <p><strong>Result:</strong> Possible deadlock, depends on execution order</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üîê Safe vs Unsafe States (Foundation for Avoidance)
                </div>
                <div class="collapsible-content">
                    <div class="important-point">
                        <h4>üìä State Definitions and Relationships</h4>
                        <div class="deadlock-diagram">
                            <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 25px;">
                                <div style="text-align: center; padding: 25px; background: #e8f5e8; border-radius: 15px; border: 3px solid #4caf50; min-width: 200px;">
                                    <h5 style="color: #2e7d32; margin-bottom: 10px;">Safe State</h5>
                                    <p><strong>‚áí No Deadlocks</strong></p>
                                    <p style="margin-top: 10px;">System can guarantee completion of all processes in some order</p>
                                    <div style="margin-top: 15px; font-size: 0.9em; background: white; padding: 10px; border-radius: 8px;">
                                        <strong>Safe Sequence Exists:</strong><br>
                                        ‚ü®P‚ÇÅ, P‚ÇÇ, ..., P‚Çô‚ü© where each P·µ¢ can complete using available + released resources
                                    </div>
                                </div>
                                
                                <div style="text-align: center; padding: 25px; background: #fff3e0; border-radius: 15px; border: 3px solid #ff9800; min-width: 200px;">
                                    <h5 style="color: #f57c00; margin-bottom: 10px;">Unsafe State</h5>
                                    <p><strong>‚áí Possibility of Deadlock</strong></p>
                                    <p style="margin-top: 10px;">Cannot guarantee all processes will complete</p>
                                    <div style="margin-top: 15px; font-size: 0.9em; background: white; padding: 10px; border-radius: 8px;">
                                        <strong>No Safe Sequence:</strong><br>
                                        May or may not lead to deadlock depending on request pattern
                                    </div>
                                </div>
                                
                                <div style="text-align: center; padding: 25px; background: #ffebee; border-radius: 15px; border: 3px solid #f44336; min-width: 200px;">
                                    <h5 style="color: #c62828; margin-bottom: 10px;">Deadlock State</h5>
                                    <p><strong>‚áí Deadlock Exists</strong></p>
                                    <p style="margin-top: 10px;">Processes are actually deadlocked right now</p>
                                    <div style="margin-top: 15px; font-size: 0.9em; background: white; padding: 10px; border-radius: 8px;">
                                        <strong>Circular Wait Present:</strong><br>
                                        Processes permanently blocked
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="algorithm-box">
                        <h4>üîÑ State Transitions</h4>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 15px 0;">
                            <p><strong>Normal Operation:</strong></p>
                            <div style="text-align: center; margin: 15px 0; font-size: 1.2em;">
                                Safe State ‚Üí Safe State ‚Üí Safe State ‚Üí ...
                            </div>
                            
                            <p><strong>Poor Resource Management:</strong></p>
                            <div style="text-align: center; margin: 15px 0; font-size: 1.2em;">
                                Safe State ‚Üí Unsafe State ‚Üí ? (May lead to deadlock)
                            </div>
                            
                            <p><strong>Deadlock Occurs:</strong></p>
                            <div style="text-align: center; margin: 15px 0; font-size: 1.2em;">
                                Safe State ‚Üí Unsafe State ‚Üí Deadlock State
                            </div>
                        </div>
                        <div class="important">
                            <p><strong>‚ö†Ô∏è Key Insight:</strong> Once in deadlock state, system cannot recover without external intervention (process termination or resource preemption).</p>
                        </div>
                    </div>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Memory Rules:</strong></p>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li><strong>No cycle = No deadlock</strong> (Golden rule)</li>
                        <li><strong>Cycle + Single instance = Deadlock</strong> (Certain)</li>
                        <li><strong>Cycle + Multiple instances = Maybe deadlock</strong> (Uncertain)</li>
                        <li><strong>Safe ‚äÇ No Deadlock</strong> (Safe is subset of no deadlock)</li>
                    </ul>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Exam Strategy:</strong> When analyzing RAGs, always: (1) Check for cycles first, (2) If cycle exists, count resource instances, (3) Determine if deadlock is certain or possible, (4) Identify which processes are involved.</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 9: What does a request edge represent in a resource allocation graph?
                        </div>
                        <div class="options" data-question="9">
                            <div class="option" data-answer="correct">A) A process requesting a resource</div>
                            <div class="option" data-answer="wrong">B) A resource allocated to a process</div>
                            <div class="option" data-answer="wrong">C) A process releasing a resource</div>
                            <div class="option" data-answer="wrong">D) A resource type definition</div>
                        </div>
                        <div class="result" id="result9"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 10: If a resource allocation graph contains no cycles, then there is no deadlock.
                        </div>
                        <div class="true-false" data-question="10">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result10"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 11: If a cycle exists and each resource type has only one instance, what can we conclude?
                        </div>
                        <div class="options" data-question="11">
                            <div class="option" data-answer="correct">A) Deadlock definitely exists</div>
                            <div class="option" data-answer="wrong">B) No deadlock</div>
                            <div class="option" data-answer="wrong">C) Possibility of deadlock</div>
                            <div class="option" data-answer="wrong">D) Cannot determine</div>
                        </div>
                        <div class="result" id="result11"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 12: In resource allocation graphs, processes are represented by <span class="fill-blank"><input type="text" data-answer="circles" placeholder="?"></span> and resources by rectangles.
                        </div>
                        <div class="result" id="result12"></div>
                        <button class="quiz-btn" data-check="12">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Continue with Prevention, Avoidance, Detection, Recovery, Methods Comparison, Quiz, and Summary sections... -->
        <!-- This is getting quite long, so I'll continue in the next part -->

        <!-- Deadlock Prevention Section -->
        <div id="prevention" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Deadlock Prevention</h2>
                
                <div class="key-concept">
                    <h3>üõ°Ô∏è Complete Deadlock Prevention Strategy</h3>
                    <p class="super-important">Restrain the ways requests can be made to ensure that at least one of the four necessary conditions cannot hold.</p>
                    <p><strong>Philosophy:</strong> Make deadlock impossible by preventing one of the four conditions.</p>
                </div>

                <div class="deadlock-conditions">
                    <div class="condition-card">
                        <h4>üîí Preventing Mutual Exclusion</h4>
                        <p><strong>Approach:</strong> Make all resources sharable</p>
                        <div style="text-align: left; margin-top: 15px;">
                            <p><span class="highlight">‚úì Possible for some resources:</span></p>
                            <ul style="margin: 10px 0 10px 20px;">
                                <li>Read-only files</li>
                                <li>Shared memory segments</li>
                                <li>Some network resources</li>
                            </ul>
                            <p><span class="super-important">‚úó Not practical for many resources:</span></p>
                            <ul style="margin: 10px 0 10px 20px;">
                                <li>Printers, tape drives</li>
                                <li>Database write locks</li>
                                <li>Critical sections</li>
                            </ul>
                        </div>
                        <div class="exam-tip" style="margin-top: 15px;">
                            <p><strong>Conclusion:</strong> Generally not feasible as main prevention strategy</p>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>‚úã Preventing Hold and Wait</h4>
                        <p><strong>Two main approaches:</strong></p>
                        <div style="text-align: left; margin-top: 15px;">
                            <p><span class="highlight">Protocol 1: Request all resources before execution</span></p>
                            <div class="code-block" style="margin: 10px 0;">
// Request everything upfront
request(file1, file2, printer, memory);
if (all_granted) {
    // Execute process
    use_resources();
    release(file1, file2, printer, memory);
}
                            </div>
                            
                            <p><span class="highlight">Protocol 2: Request resources only when none held</span></p>
                            <div class="code-block" style="margin: 10px 0;">
// Release all before requesting new ones
release_all_current_resources();
request(new_resources_needed);
if (granted) {
    reacquire_old_resources();
    continue_execution();
}
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <p><strong>Disadvantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px; text-align: left;">
                                <li><span class="super-important">Low resource utilization</span></li>
                                <li><span class="super-important">Starvation possible</span></li>
                                <li>Difficult to predict all needed resources</li>
                                <li>May hold resources unnecessarily long</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üö´ Preventing No Preemption</h4>
                        <p><strong>Two protocols:</strong></p>
                        <div style="text-align: left; margin-top: 15px;">
                            <p><span class="highlight">Protocol 1: Preempt requesting process</span></p>
                            <div class="code-block" style="margin: 10px 0;">
if (process_requests_unavailable_resource()) {
    preempt_all_resources_from_requester();
    add_to_waiting_list();
    restart_when_all_available();
}
                            </div>
                            
                            <p><span class="highlight">Protocol 2: Preempt holding process</span></p>
                            <div class="code-block" style="margin: 10px 0;">
if (process_requests_unavailable_resource()) {
    if (holder_is_waiting_for_other_resources()) {
        preempt_from_holder();
        allocate_to_requester();
    } else {
        requester_waits();
    }
}
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <p><strong>Applicability:</strong></p>
                            <ul style="margin: 5px 0 5px 20px; text-align: left;">
                                <li><span class="highlight">‚úì CPU, memory (with state saving)</span></li>
                                <li><span class="super-important">‚úó Printers, tape drives, database locks</span></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üîÑ Preventing Circular Wait</h4>
                        <p><strong>Impose total ordering on resource types</strong></p>
                        <div style="text-align: left; margin-top: 15px;">
                            <p><span class="highlight">Define ordering function F: R ‚Üí N</span></p>
                            <div class="code-block" style="margin: 10px 0;">
// Example ordering
F(tape_drive) = 1
F(disk_drive) = 5  
F(printer) = 12
F(network) = 15

// Protocol: Request in increasing order only
request(tape_drive);     // F = 1
request(disk_drive);     // F = 5 (OK, 5 > 1)
request(printer);        // F = 12 (OK, 12 > 5)
// Cannot request tape_drive now (F = 1 < 12)
                            </div>
                            
                            <p><span class="highlight">Alternative protocol:</span></p>
                            <div class="code-block" style="margin: 10px 0;">
// Can request Rj only if F(Rj) > F(Ri) 
// for all currently held resources Ri
if (F(requested_resource) > F(max_held_resource)) {
    grant_request();
} else {
    release_higher_numbered_resources_first();
    then_request_in_order();
}
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <p><strong>Why it works:</strong></p>
                            <ul style="margin: 5px 0 5px 20px; text-align: left;">
                                <li>Eliminates circular wait condition</li>
                                <li>Creates partial order on resource acquisition</li>
                                <li>Most practical prevention method</li>
                            </ul>
                            
                            <p><strong>Disadvantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px; text-align: left;">
                                <li>May conflict with program structure</li>
                                <li>Difficult to define universal ordering</li>
                                <li>May lead to resource underutilization</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="important">
                    <h4>üìä Prevention Methods Comparison</h4>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Prevention Method</th>
                                <th>Practicality</th>
                                <th>Resource Utilization</th>
                                <th>System Throughput</th>
                                <th>Complexity</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Prevent Mutual Exclusion</strong></td>
                                <td>Low</td>
                                <td>High</td>
                                <td>High</td>
                                <td>Low</td>
                            </tr>
                            <tr>
                                <td><strong>Prevent Hold & Wait</strong></td>
                                <td>Medium</td>
                                <td>Low</td>
                                <td>Low</td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td><strong>Allow Preemption</strong></td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>High</td>
                            </tr>
                            <tr>
                                <td><strong>Prevent Circular Wait</strong></td>
                                <td>High</td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>Medium</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Prevention Memory Technique:</strong> "All Before, Release All, Order Always" - Request all before execution, release all when blocked, always maintain resource ordering!</p>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Most Important:</strong> Know why preventing circular wait is most practical, and understand the resource ordering protocol with examples.</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 13: Which deadlock prevention approach is generally most practical?
                        </div>
                        <div class="options" data-question="13">
                            <div class="option" data-answer="wrong">A) Preventing mutual exclusion</div>
                            <div class="option" data-answer="wrong">B) Preventing hold and wait</div>
                            <div class="option" data-answer="wrong">C) Allowing preemption</div>
                            <div class="option" data-answer="correct">D) Preventing circular wait</div>
                        </div>
                        <div class="result" id="result13"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 14: To prevent hold and wait, a process must request all resources before beginning execution.
                        </div>
                        <div class="true-false" data-question="14">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result14"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 15: To prevent circular wait, we impose a <span class="fill-blank"><input type="text" data-answer="total ordering" placeholder="?"></span> of all resource types.
                        </div>
                        <div class="result" id="result15"></div>
                        <button class="quiz-btn" data-check="15">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deadlock Avoidance Section -->
        <div id="avoidance" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Deadlock Avoidance</h2>
                
                <div class="definition-box">
                    <h3>üéØ Complete Deadlock Avoidance Strategy</h3>
                    <p class="super-important">Requires that the system has additional a priori information about how resources will be used.</p>
                    <p><strong>Philosophy:</strong> Allow all four conditions to exist but avoid unsafe states through careful resource allocation.</p>
                </div>

                <div class="key-concept">
                    <h4>üìã Requirements for Deadlock Avoidance:</h4>
                    <ul style="line-height: 2;">
                        <li><span class="super-important">Each process declares maximum number of resources needed of each type</span></li>
                        <li><span class="highlight">Dynamically examine resource-allocation state</span></li>
                        <li><span class="highlight">Ensure system never enters unsafe state</span></li>
                        <li><span class="highlight">Resource-allocation state defined by:</span>
                            <ul style="margin-left: 25px; margin-top: 10px;">
                                <li>Number of available resources</li>
                                <li>Number of allocated resources</li>
                                <li>Maximum demands of processes</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üîê Safe State - Complete Definition and Examples
                </div>
                <div class="collapsible-content">
                    <div class="important">
                        <h4>‚úÖ Formal Safe State Definition:</h4>
                        <p><strong>A state is safe if there exists a safe sequence of all processes.</strong></p>
                        <div class="algorithm-box">
                            <h5>üìê Mathematical Definition:</h5>
                            <p>A sequence ‚ü®P‚ÇÅ, P‚ÇÇ, ..., P‚Çô‚ü© is safe for the current allocation state if:</p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <strong>For each P·µ¢ (i = 1, 2, ..., n):</strong><br><br>
                                <strong>Need[P·µ¢] ‚â§ Available + Œ£(Allocation[P‚±º]) for all j &lt; i</strong><br><br>
                                Where:<br>
                                ‚Ä¢ Need[P·µ¢] = Maximum[P·µ¢] - Allocation[P·µ¢]<br>
                                ‚Ä¢ Available = currently available resources<br>
                                ‚Ä¢ Allocation[P‚±º] = resources allocated to process P‚±º
                            </div>
                        </div>
                        
                        <div class="important-point">
                            <h5>üîç Safe State Example:</h5>
                            <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; border: 2px solid #4caf50;">
                                <table style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                                    <thead>
                                        <tr style="background: #4caf50; color: white;">
                                            <th style="padding: 8px;">Process</th>
                                            <th style="padding: 8px;">Allocation</th>
                                            <th style="padding: 8px;">Max</th>
                                            <th style="padding: 8px;">Need</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td style="padding: 8px; border: 1px solid #ddd;">P0</td><td style="padding: 8px; border: 1px solid #ddd;">0</td><td style="padding: 8px; border: 1px solid #ddd;">7</td><td style="padding: 8px; border: 1px solid #ddd;">7</td></tr>
                                        <tr><td style="padding: 8px; border: 1px solid #ddd;">P1</td><td style="padding: 8px; border: 1px solid #ddd;">2</td><td style="padding: 8px; border: 1px solid #ddd;">3</td><td style="padding: 8px; border: 1px solid #ddd;">1</td></tr>
                                        <tr><td style="padding: 8px; border: 1px solid #ddd;">P2</td><td style="padding: 8px; border: 1px solid #ddd;">3</td><td style="padding: 8px; border: 1px solid #ddd;">9</td><td style="padding: 8px; border: 1px solid #ddd;">6</td></tr>
                                    </tbody>
                                </table>
                                <p><strong>Available = 2</strong></p>
                                <p><strong>Safe sequence: ‚ü®P1, P0, P2‚ü©</strong></p>
                                <ol style="margin-top: 10px; text-align: left;">
                                    <li>P1: Need(1) ‚â§ Available(2) ‚úì ‚Üí P1 completes, releases 2+2=4</li>
                                    <li>P0: Need(7) ‚â§ Available(4) ‚úó ‚Üí Need more resources</li>
                                    <li>Try P2: Need(6) ‚â§ Available(2) ‚úó ‚Üí Need more resources</li>
                                    <li>Back to P1: Completes, Available = 2+2 = 4</li>
                                    <li>P0: Need(7) ‚â§ Available(4) ‚úó ‚Üí Still need more</li>
                                    <li>Wait, let me recalculate: P1 finishes ‚Üí Available = 2+2 = 4</li>
                                    <li>P0: Need(7) > Available(4) ‚Üí Cannot satisfy P0</li>
                                    <li>This would be UNSAFE state actually</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üìà Banker's Algorithm - Complete Implementation
                </div>
                <div class="collapsible-content">
                    <div class="algorithm-box">
                        <h4>üè¶ Banker's Algorithm - Complete Version</h4>
                        <p><strong>Used for systems with multiple instances of multiple resource types</strong></p>
                        
                        <h5>üìä Data Structures:</h5>
                        <ul style="line-height: 2;">
                            <li><span class="highlight">Available[m]:</span> Vector of length m indicating number of available instances of each resource type</li>
                            <li><span class="highlight">Max[n][m]:</span> n√óm matrix defining maximum demand of each process</li>
                            <li><span class="highlight">Allocation[n][m]:</span> n√óm matrix defining number of resources currently allocated to each process</li>
                            <li><span class="highlight">Need[n][m]:</span> n√óm matrix indicating remaining resource need of each process</li>
                        </ul>
                        
                        <div class="important-point">
                            <h5>üîó Key Relationship:</h5>
                            <div style="text-align: center; font-size: 1.3em; margin: 15px 0; background: #fff3cd; padding: 15px; border-radius: 8px;">
                                <strong>Need[i][j] = Max[i][j] - Allocation[i][j]</strong>
                            </div>
                        </div>
                        
                        <h5>üîç Safety Algorithm (Heart of Banker's Algorithm):</h5>
                        <div class="code-block">
Algorithm: Safety_Check()
Input: Available[], Max[][], Allocation[][], Need[][]
Output: True if system is in safe state, False otherwise

1. Initialize:
   Work[m] = Available[m]  // Working copy of available resources
   Finish[n] = {false, false, ..., false}  // All processes unfinished
   
2. Find an index i such that both:
   a) Finish[i] == false
   b) Need[i] ‚â§ Work  // Process i's need can be satisfied
   
   If no such i exists, go to step 4

3. Simulate process i completion:
   Work = Work + Allocation[i]  // Process releases resources
   Finish[i] = true
   Go to step 2

4. Check result:
   If Finish[i] == true for all i:
       Return SAFE (safe sequence exists)
   Else:
       Return UNSAFE (no safe sequence)
                        </div>
                        
                        <h5>üìù Resource-Request Algorithm:</h5>
                        <div class="code-block">
Algorithm: Resource_Request(process_id, request[])
Input: Process ID and requested resources
Output: Grant or deny the request

1. Check if Request ‚â§ Need[process_id]
   If not: ERROR (process exceeded its maximum claim)

2. Check if Request ‚â§ Available
   If not: Process must wait (resources not available)

3. Simulate allocation:
   Available = Available - Request
   Allocation[process_id] = Allocation[process_id] + Request
   Need[process_id] = Need[process_id] - Request

4. Run Safety_Check():
   If SAFE:
       Grant the request (allocation is permanent)
   Else:
       Deny the request (rollback the simulation)
       Available = Available + Request
       Allocation[process_id] = Allocation[process_id] - Request
       Need[process_id] = Need[process_id] + Request
                        </div>
                    </div>
                    
                    <div class="important-point">
                        <h4>üìä Complete Banker's Algorithm Example:</h4>
                        <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; border: 2px solid #2196f3;">
                            <p><strong>System:</strong> 5 processes {P0, P1, P2, P3, P4}, 3 resource types {A, B, C}</p>
                            <p><strong>Current state:</strong></p>
                            
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 15px 0;">
                                <div>
                                    <h6><strong>Allocation Matrix:</strong></h6>
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <tr style="background: #2196f3; color: white;"><th style="padding: 5px;">Process</th><th style="padding: 5px;">A</th><th style="padding: 5px;">B</th><th style="padding: 5px;">C</th></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">1</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P1</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P2</td><td style="padding: 5px; border: 1px solid #ddd;">3</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P3</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">1</td><td style="padding: 5px; border: 1px solid #ddd;">1</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P4</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                    </table>
                                </div>
                                
                                <div>
                                    <h6><strong>Max Matrix:</strong></h6>
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <tr style="background: #2196f3; color: white;"><th style="padding: 5px;">Process</th><th style="padding: 5px;">A</th><th style="padding: 5px;">B</th><th style="padding: 5px;">C</th></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P0</td><td style="padding: 5px; border: 1px solid #ddd;">7</td><td style="padding: 5px; border: 1px solid #ddd;">5</td><td style="padding: 5px; border: 1px solid #ddd;">3</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P1</td><td style="padding: 5px; border: 1px solid #ddd;">3</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P2</td><td style="padding: 5px; border: 1px solid #ddd;">9</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P3</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                        <tr><td style="padding: 5px; border: 1px solid #ddd;">P4</td><td style="padding: 5px; border: 1px solid #ddd;">4</td><td style="padding: 5px; border: 1px solid #ddd;">3</td><td style="padding: 5px; border: 1px solid #ddd;">3</td></tr>
                                    </table>
                                </div>
                            </div>
                            
                            <p><strong>Available = (3, 3, 2)</strong></p>
                            
                            <div class="code-block">
Safety Check:
Need Matrix = Max - Allocation:
P0: (7,4,3), P1: (1,2,2), P2: (6,0,0), P3: (0,1,1), P4: (4,3,1)

Step 1: Work = (3,3,2), Check each process
- P0: Need(7,4,3) > Work(3,3,2) ‚úó
- P1: Need(1,2,2) ‚â§ Work(3,3,2) ‚úì ‚Üí P1 can complete

Step 2: P1 completes, Work = (3,3,2) + (2,0,0) = (5,3,2)
- P0: Need(7,4,3) > Work(5,3,2) ‚úó
- P2: Need(6,0,0) > Work(5,3,2) ‚úó
- P3: Need(0,1,1) ‚â§ Work(5,3,2) ‚úì ‚Üí P3 can complete

Step 3: P3 completes, Work = (5,3,2) + (2,1,1) = (7,4,3)
- P0: Need(7,4,3) ‚â§ Work(7,4,3) ‚úì ‚Üí P0 can complete

Step 4: P0 completes, Work = (7,4,3) + (0,1,0) = (7,5,3)
- P2: Need(6,0,0) ‚â§ Work(7,5,3) ‚úì ‚Üí P2 can complete

Step 5: P2 completes, Work = (7,5,3) + (3,0,2) = (10,5,5)
- P4: Need(4,3,1) ‚â§ Work(10,5,5) ‚úì ‚Üí P4 can complete

Safe sequence: ‚ü®P1, P3, P0, P2, P4‚ü©
Result: SAFE STATE
                            </div>
                        </div>
                    </div>
                </div>

                <div class="important">
                    <h4>‚öñÔ∏è Advantages and Disadvantages of Banker's Algorithm</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; border: 2px solid #4caf50;">
                            <h5 style="color: #2e7d32;">‚úÖ Advantages:</h5>
                            <ul style="text-align: left;">
                                <li>Guarantees deadlock will never occur</li>
                                <li>Better resource utilization than prevention</li>
                                <li>No process termination or rollback needed</li>
                                <li>Mathematically provable correctness</li>
                            </ul>
                        </div>
                        <div style="background: #ffebee; padding: 20px; border-radius: 10px; border: 2px solid #f44336;">
                            <h5 style="color: #c62828;">‚ùå Disadvantages:</h5>
                            <ul style="text-align: left;">
                                <li>Requires advance knowledge of maximum needs</li>
                                <li>Fixed number of processes and resources</li>
                                <li>Conservative (may deny safe requests)</li>
                                <li>High computational overhead</li>
                                <li>Rare in practice due to restrictions</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Banker's Algorithm Memory:</strong> "Bank before you lend" - Always check if the system remains in a safe state before granting any resource request.</p>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Exam Focus:</strong> Be able to execute the safety algorithm step-by-step, calculate Need matrix, and determine if a given state is safe or unsafe. Practice with numerical examples!</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 16: What information is required for deadlock avoidance?
                        </div>
                        <div class="options" data-question="16">
                            <div class="option" data-answer="correct">A) Maximum resource requirements of each process</div>
                            <div class="option" data-answer="wrong">B) Process priorities only</div>
                            <div class="option" data-answer="wrong">C) Process execution times</div>
                            <div class="option" data-answer="wrong">D) Current CPU utilization</div>
                        </div>
                        <div class="result" id="result16"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 17: A safe state guarantees that no deadlock can occur.
                        </div>
                        <div class="true-false" data-question="17">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result17"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 18: The most famous deadlock avoidance algorithm is called the <span class="fill-blank"><input type="text" data-answer="banker's algorithm" placeholder="?"></span>.
                        </div>
                        <div class="result" id="result18"></div>
                        <button class="quiz-btn" data-check="18">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deadlock Detection Section -->
        <div id="detection" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Deadlock Detection</h2>
                
                <div class="definition-box">
                    <h3>üîç Complete Deadlock Detection Strategy</h3>
                    <p class="super-important">Allow system to enter deadlock state, then detect it and initiate recovery procedures.</p>
                    <p><strong>Philosophy:</strong> Don't prevent deadlock, but detect when it occurs and deal with it.</p>
                </div>

                <div class="key-concept">
                    <h4>üîß Complete Detection System Components:</h4>
                    <div class="deadlock-conditions">
                        <div class="condition-card">
                            <h4>üîç Detection Algorithm</h4>
                            <p>Systematic method to search for deadlock cycles</p>
                            <ul style="text-align: left; margin-top: 10px;">
                                <li>Single instance: Wait-for graph</li>
                                <li>Multiple instances: Resource allocation graph analysis</li>
                                <li>Periodic or triggered execution</li>
                            </ul>
                        </div>
                        
                        <div class="condition-card">
                            <h4>üö® Recovery Scheme</h4>
                            <p>Method to break deadlock when detected</p>
                            <ul style="text-align: left; margin-top: 10px;">
                                <li>Process termination</li>
                                <li>Resource preemption</li>
                                <li>Rollback mechanisms</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üìä Single Instance Detection - Wait-for Graph Method
                </div>
                <div class="collapsible-content">
                    <div class="algorithm-box">
                        <h4>üîó Wait-for Graph Approach</h4>
                        <p><strong>Used when each resource type has exactly one instance</strong></p>
                        
                        <h5>üìê Graph Construction:</h5>
                        <ul style="line-height: 2;">
                            <li><span class="highlight">Nodes:</span> Only processes (resources removed)</li>
                            <li><span class="highlight">Edges:</span> Pi ‚Üí Pj if Pi is waiting for Pj to release a resource</li>
                            <li><span class="highlight">Deadlock:</span> Cycle in wait-for graph</li>
                        </ul>
                        
                        <div class="important-point">
                            <h5>üîÑ RAG to Wait-for Graph Conversion:</h5>
                            <div class="deadlock-diagram">
                                <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 30px;">
                                    <div style="text-align: center;">
                                        <h6><strong>Resource Allocation Graph</strong></h6>
                                        <div style="border: 3px solid #28503e; padding: 20px; border-radius: 12px; background: #f9f9f9;">
                                            <div style="display: flex; align-items: center; justify-content: center; margin: 15px 0;">
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P1</div>
                                                <div class="arrow" style="width: 30px;"></div>
                                                <div class="resource-node" style="width: 50px; height: 40px; font-size: 0.8em;">R1</div>
                                                <div class="arrow" style="width: 30px;"></div>
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P2</div>
                                            </div>
                                            <div style="display: flex; align-items: center; justify-content: center; margin: 15px 0;">
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P3</div>
                                                <div class="arrow" style="width: 30px;"></div>
                                                <div class="resource-node" style="width: 50px; height: 40px; font-size: 0.8em;">R2</div>
                                                <div class="arrow" style="width: 30px;"></div>
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P1</div>
                                            </div>
                                        </div>
                                        <p style="margin-top: 10px;">P1‚ÜíR1‚ÜíP2, P3‚ÜíR2‚ÜíP1</p>
                                    </div>
                                    
                                    <div style="font-size: 2.5em; color: #28503e;">‚áí</div>
                                    
                                    <div style="text-align: center;">
                                        <h6><strong>Wait-for Graph</strong></h6>
                                        <div style="border: 3px solid #28503e; padding: 20px; border-radius: 12px; background: #f9f9f9;">
                                            <div style="display: flex; align-items: center; justify-content: center; margin: 15px 0;">
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P1</div>
                                                <div class="arrow" style="width: 40px;"></div>
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P2</div>
                                            </div>
                                            <div style="display: flex; align-items: center; justify-content: center; margin: 15px 0;">
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P3</div>
                                                <div class="arrow" style="width: 40px;"></div>
                                                <div class="process-node" style="width: 50px; height: 50px; font-size: 0.9em;">P1</div>
                                            </div>
                                        </div>
                                        <p style="margin-top: 10px;">P1‚ÜíP2, P3‚ÜíP1</p>
                                        <p><strong>No cycle = No deadlock</strong></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h5>üîç Cycle Detection Algorithm:</h5>
                        <div class="code-block">
Algorithm: Detect_Cycle_Wait_For_Graph(Graph G)
Input: Wait-for graph G with n processes
Output: True if deadlock exists, False otherwise
Time Complexity: O(n¬≤)

1. For each process Pi in graph:
   2. visited[1..n] = false
   3. If DFS_Cycle_Detection(Pi, visited) returns true:
      4. Return DEADLOCK_DETECTED
5. Return NO_DEADLOCK

DFS_Cycle_Detection(current_process, visited[]):
1. If visited[current_process] == true:
   2. Return true  // Cycle found!
3. visited[current_process] = true
4. For each process Pj that current_process is waiting for:
   5. If DFS_Cycle_Detection(Pj, visited) returns true:
      6. Return true
7. visited[current_process] = false  // Backtrack
8. Return false
                        </div>
                    </div>
                    
                    <div class="important-point">
                        <h4>üìà Wait-for Graph Example with Deadlock:</h4>
                        <div style="background: #ffebee; padding: 20px; border-radius: 10px; border: 2px solid #f44336;">
                            <h5 style="color: #c62828;">Deadlock Scenario:</h5>
                            <div class="code-block">
Initial State:
P1 holds R1, requests R2
P2 holds R2, requests R3  
P3 holds R3, requests R1

Wait-for Graph:
P1 ‚Üí P2 (P1 waits for P2 to release R2)
P2 ‚Üí P3 (P2 waits for P3 to release R3)
P3 ‚Üí P1 (P3 waits for P1 to release R1)

Cycle: P1 ‚Üí P2 ‚Üí P3 ‚Üí P1
Result: DEADLOCK DETECTED!
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üìà Multiple Instance Detection Algorithm
                </div>
                <div class="collapsible-content">
                    <div class="algorithm-box">
                        <h4>üìä Detection Algorithm for Multiple Instances</h4>
                        <p><strong>Similar to Banker's algorithm but works with current state only</strong></p>
                        
                        <h5>üìã Data Structures:</h5>
                        <ul style="line-height: 2;">
                            <li><span class="highlight">Available[m]:</span> Vector of available instances of each resource type</li>
                            <li><span class="highlight">Allocation[n][m]:</span> Current allocation matrix</li>
                            <li><span class="highlight">Request[n][m]:</span> Current request matrix (instead of Need matrix)</li>
                        </ul>
                        
                        <h5>üîç Detection Algorithm:</h5>
                        <div class="code-block">
Algorithm: Deadlock_Detection()
Input: Available[], Allocation[][], Request[][]
Output: True if deadlock exists, False otherwise

1. Initialize:
   Work[m] = Available[m]
   Finish[n] = {false for all i where Allocation[i] ‚â† 0}
            = {true for all i where Allocation[i] == 0}

2. Find an index i such that both:
   a) Finish[i] == false
   b) Request[i] ‚â§ Work
   
   If no such i exists, go to step 4

3. Process i can complete:
   Work = Work + Allocation[i]
   Finish[i] = true
   Go to step 2

4. Check for deadlock:
   If Finish[i] == false for some i:
       Return DEADLOCK (processes with Finish[i]==false are deadlocked)
   Else:
       Return NO_DEADLOCK
                        </div>
                        
                        <div class="important-point">
                            <h5>üìä Detection Algorithm Example:</h5>
                            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; border: 2px solid #2196f3;">
                                <p><strong>System state:</strong> 5 processes, 3 resource types</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 15px 0;">
                                    <div>
                                        <h6><strong>Allocation:</strong></h6>
                                        <table style="width: 100%; border-collapse: collapse;">
                                            <tr style="background: #2196f3; color: white;"><th style="padding: 5px;">P</th><th style="padding: 5px;">A</th><th style="padding: 5px;">B</th><th style="padding: 5px;">C</th></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">1</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P1</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P2</td><td style="padding: 5px; border: 1px solid #ddd;">3</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">3</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P3</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">1</td><td style="padding: 5px; border: 1px solid #ddd;">1</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P4</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                        </table>
                                    </div>
                                    
                                    <div>
                                        <h6><strong>Request:</strong></h6>
                                        <table style="width: 100%; border-collapse: collapse;">
                                            <tr style="background: #2196f3; color: white;"><th style="padding: 5px;">P</th><th style="padding: 5px;">A</th><th style="padding: 5px;">B</th><th style="padding: 5px;">C</th></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P1</td><td style="padding: 5px; border: 1px solid #ddd;">2</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P2</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P3</td><td style="padding: 5px; border: 1px solid #ddd;">1</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td></tr>
                                            <tr><td style="padding: 5px; border: 1px solid #ddd;">P4</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">0</td><td style="padding: 5px; border: 1px solid #ddd;">2</td></tr>
                                        </table>
                                    </div>
                                </div>
                                
                                <p><strong>Available = (0, 0, 0)</strong></p>
                                
                                <div class="code-block">
Detection Algorithm Execution:

Step 1: Work = (0,0,0)
        Finish = [false, false, false, false, false]
        
Step 2: Look for process with Request ‚â§ Work
        P0: Request(0,0,0) ‚â§ Work(0,0,0) ‚úì
        
Step 3: P0 can complete
        Work = (0,0,0) + (0,1,0) = (0,1,0)
        Finish[0] = true
        
Step 4: Look for next process
        P1: Request(2,0,2) > Work(0,1,0) ‚úó
        P2: Request(0,0,0) ‚â§ Work(0,1,0) ‚úì
        
Step 5: P2 can complete  
        Work = (0,1,0) + (3,0,3) = (3,1,3)
        Finish[2] = true
        
Step 6: Continue...
        P1: Request(2,0,2) ‚â§ Work(3,1,3) ‚úì
        P3: Request(1,0,0) ‚â§ Work(3,1,3) ‚úì
        P4: Request(0,0,2) ‚â§ Work(3,1,3) ‚úì

Result: All processes can complete ‚Üí NO DEADLOCK
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="important">
                    <h4>‚è∞ When to Invoke Detection Algorithm?</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div style="background: #fff3e0; padding: 15px; border-radius: 10px; border: 2px solid #ff9800;">
                            <h5 style="color: #f57c00;">üïê Periodic</h5>
                            <ul style="text-align: left; margin-top: 10px;">
                                <li>Every hour</li>
                                <li>Every day</li>
                                <li>When CPU utilization drops below threshold</li>
                            </ul>
                            <p><strong>Trade-off:</strong> Frequency vs overhead</p>
                        </div>
                        
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 10px; border: 2px solid #4caf50;">
                            <h5 style="color: #2e7d32;">üö® On Request Denial</h5>
                            <ul style="text-align: left; margin-top: 10px;">
                                <li>When resource request cannot be granted</li>
                                <li>Immediate detection</li>
                                <li>Higher overhead</li>
                            </ul>
                            <p><strong>Advantage:</strong> Quick detection</p>
                        </div>
                        
                        <div style="background: #f3e5f5; padding: 15px; border-radius: 10px; border: 2px solid #9c27b0;">
                            <h5 style="color: #7b1fa2;">üìä Hybrid Approach</h5>
                            <ul style="text-align: left; margin-top: 10px;">
                                <li>Combine both methods</li>
                                <li>Adaptive frequency</li>
                                <li>Based on system load</li>
                            </ul>
                            <p><strong>Best:</strong> Balance detection time and overhead</p>
                        </div>
                    </div>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Detection vs Avoidance:</strong> Detection algorithm is like Banker's algorithm but works with current requests (not maximum needs) and doesn't prevent unsafe states.</p>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Key Exam Points:</strong> Know how to convert RAG to wait-for graph, execute detection algorithm step-by-step, and understand when detection should be invoked.</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 19: In a wait-for graph, what do the nodes represent?
                        </div>
                        <div class="options" data-question="19">
                            <div class="option" data-answer="correct">A) Processes only</div>
                            <div class="option" data-answer="wrong">B) Resources only</div>
                            <div class="option" data-answer="wrong">C) Both processes and resources</div>
                            <div class="option" data-answer="wrong">D) System states</div>
                        </div>
                        <div class="result" id="result19"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 20: The complexity of cycle detection in a wait-for graph is O(n¬≤).
                        </div>
                        <div class="true-false" data-question="20">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result20"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 21: In deadlock detection, we maintain a <span class="fill-blank"><input type="text" data-answer="wait-for" placeholder="?"></span> graph for single instance resources.
                        </div>
                        <div class="result" id="result21"></div>
                        <button class="quiz-btn" data-check="21">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recovery from Deadlock Section -->
        <div id="recovery" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Recovery from Deadlock</h2>
                
                <div class="key-concept">
                    <h3>üîß Complete Recovery Strategies</h3>
                    <p class="super-important">Two main approaches: terminate processes or preempt resources to break the deadlock cycle.</p>
                    <p><strong>Goal:</strong> Restore system to normal operation with minimal cost and disruption.</p>
                </div>

                <div class="deadlock-conditions">
                    <div class="condition-card">
                        <h4>üíÄ 1. Process Termination</h4>
                        <p><strong>Two strategies:</strong></p>
                        <div style="text-align: left; margin-top: 15px;">
                            <p><span class="super-important">Abort all deadlocked processes:</span></p>
                            <ul style="margin: 10px 0 10px 20px;">
                                <li>‚úì Simple and immediate</li>
                                <li>‚úó Expensive (all work lost)</li>
                                <li>‚úó May terminate too many processes</li>
                            </ul>
                            
                            <p><span class="highlight">Abort one process at a time:</span></p>
                            <ul style="margin: 10px 0 10px 20px;">
                                <li>‚úì Minimal process termination</li>
                                <li>‚úì Can choose victim intelligently</li>
                                <li>‚úó Overhead of repeated detection</li>
                                <li>‚úó May take several iterations</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üîÑ 2. Resource Preemption</h4>
                        <p><strong>Three main issues:</strong></p>
                        <div style="text-align: left; margin-top: 15px;">
                            <p><span class="highlight">Selecting a victim:</span></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Minimize cost of preemption</li>
                                <li>Consider process priority and progress</li>
                            </ul>
                            
                            <p><span class="highlight">Rollback:</span></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Total rollback (restart process)</li>
                                <li>Partial rollback (to safe state)</li>
                            </ul>
                            
                            <p><span class="highlight">Starvation:</span></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Same process shouldn't always be victim</li>
                                <li>Include rollback count in cost function</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üíÄ Process Termination - Complete Analysis
                </div>
                <div class="collapsible-content">
                    <div class="important">
                        <h4>üìã Comprehensive Criteria for Process Selection</h4>
                        <p><strong>When deciding which process to terminate, consider:</strong></p>
                        
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Factor</th>
                                    <th>Description</th>
                                    <th>Selection Preference</th>
                                    <th>Impact on Cost</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Priority</strong></td>
                                    <td>Process priority level</td>
                                    <td>Lower priority first</td>
                                    <td>Minimal user impact</td>
                                </tr>
                                <tr>
                                    <td><strong>Computation Time</strong></td>
                                    <td>How long process has been running</td>
                                    <td>Less computation time first</td>
                                    <td>Less work lost</td>
                                </tr>
                                <tr>
                                    <td><strong>Remaining Time</strong></td>
                                    <td>Estimated time to completion</td>
                                    <td>More remaining time first</td>
                                    <td>Less immediate loss</td>
                                </tr>
                                <tr>
                                    <td><strong>Resources Used</strong></td>
                                    <td>Total resources consumed</td>
                                    <td>Fewer resources first</td>
                                    <td>Less resource waste</td>
                                </tr>
                                <tr>
                                    <td><strong>Resources Needed</strong></td>
                                    <td>Resources needed to complete</td>
                                    <td>More resources needed first</td>
                                    <td>Easier to satisfy others</td>
                                </tr>
                                <tr>
                                    <td><strong>Process Count</strong></td>
                                    <td>Number of processes to terminate</td>
                                    <td>Terminate fewer processes</td>
                                    <td>Minimal disruption</td>
                                </tr>
                                <tr>
                                    <td><strong>Process Type</strong></td>
                                    <td>Interactive vs batch process</td>
                                    <td>Batch before interactive</td>
                                    <td>Less user frustration</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="algorithm-box">
                        <h4>üîç Process Selection Algorithm</h4>
                        <div class="code-block">
Algorithm: Select_Victim_Process(deadlocked_processes[])
Input: List of processes involved in deadlock
Output: Process to terminate

1. For each process Pi in deadlocked_processes:
   2. Calculate cost_factor[i] = weighted_sum(
        priority_cost[i],
        computation_time_cost[i], 
        remaining_time_cost[i],
        resources_used_cost[i],
        resources_needed_cost[i],
        termination_count_cost[i],
        process_type_cost[i]
      )

3. Select process with minimum cost_factor
4. Return selected_process

// Example cost calculation
cost_factor[i] = w1 * (max_priority - priority[i]) +
                 w2 * computation_time[i] +
                 w3 * (max_remaining - remaining_time[i]) +
                 w4 * resources_used[i] +
                 w5 * resources_needed[i] +
                 w6 * previous_terminations[i] +
                 w7 * process_type_penalty[i]
                        </div>
                    </div>
                    
                    <div class="important-point">
                        <h4>üìä Termination Strategy Comparison:</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="background: #ffebee; padding: 20px; border-radius: 10px; border: 2px solid #f44336;">
                                <h5 style="color: #c62828;">üö® Abort All Deadlocked Processes</h5>
                                <p><strong>Advantages:</strong></p>
                                <ul style="text-align: left;">
                                    <li>Simple implementation</li>
                                    <li>Guaranteed deadlock resolution</li>
                                    <li>No need for victim selection</li>
                                    <li>Immediate recovery</li>
                                </ul>
                                <p><strong>Disadvantages:</strong></p>
                                <ul style="text-align: left;">
                                    <li>High cost (all work lost)</li>
                                    <li>May terminate critical processes</li>
                                    <li>Poor resource utilization</li>
                                    <li>User frustration</li>
                                </ul>
                            </div>
                            
                            <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; border: 2px solid #4caf50;">
                                <h5 style="color: #2e7d32;">üéØ Abort One Process at a Time</h5>
                                <p><strong>Advantages:</strong></p>
                                <ul style="text-align: left;">
                                    <li>Minimal process termination</li>
                                    <li>Intelligent victim selection</li>
                                    <li>Lower overall cost</li>
                                    <li>Better resource utilization</li>
                                </ul>
                                <p><strong>Disadvantages:</strong></p>
                                <ul style="text-align: left;">
                                    <li>Complex victim selection</li>
                                    <li>Repeated deadlock detection needed</li>
                                    <li>Possible multiple iterations</li>
                                    <li>Longer recovery time</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-divider"></div>

                <div class="collapsible" onclick="toggleCollapsible(this)">
                    üîÑ Resource Preemption - Complete Analysis
                </div>
                <div class="collapsible-content">
                    <div class="algorithm-box">
                        <h4>üîß Complete Resource Preemption Process</h4>
                        
                        <h5>üéØ 1. Victim Selection (Detailed)</h5>
                        <div class="code-block">
Algorithm: Select_Preemption_Victim()
Input: Current system state
Output: Process to preempt resources from

1. Identify candidate processes for preemption
2. For each candidate process Pi:
   3. Calculate preemption_cost[i] = 
      // Number of resources held
      resource_count[i] * resource_weight +
      
      // Process progress (prefer less progress)
      (1 - progress_percentage[i]) * progress_weight +
      
      // Process priority (prefer lower priority)  
      (max_priority - priority[i]) * priority_weight +
      
      // Rollback cost (state saving/restoration)
      estimated_rollback_cost[i] * rollback_weight +
      
      // Previous preemption count (avoid starvation)
      previous_preemptions[i] * starvation_weight

4. Select process with minimum preemption_cost
5. Return victim_process
                        </div>
                        
                        <h5>‚è™ 2. Rollback Strategies (Detailed)</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="background: #fff3e0; padding: 15px; border-radius: 10px; border: 2px solid #ff9800;">
                                <h6 style="color: #f57c00;"><strong>Total Rollback</strong></h6>
                                <div class="code-block" style="margin: 10px 0;">
Process_Total_Rollback(victim_process):
1. Save current process state
2. Preempt all resources from victim
3. Terminate victim process
4. Add victim to ready queue
5. Reschedule victim from beginning
6. Update resource allocation tables
                                </div>
                                <p><strong>Characteristics:</strong></p>
                                <ul style="text-align: left; font-size: 0.9em;">
                                    <li>‚úì Simple implementation</li>
                                    <li>‚úì No complex state management</li>
                                    <li>‚úó All work lost</li>
                                    <li>‚úó High cost</li>
                                </ul>
                            </div>
                            
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; border: 2px solid #2196f3;">
                                <h6 style="color: #1976d2;"><strong>Partial Rollback</strong></h6>
                                <div class="code-block" style="margin: 10px 0;">
Process_Partial_Rollback(victim_process):
1. Identify safe checkpoint
2. Rollback to last safe state
3. Preempt only necessary resources
4. Restore process to checkpoint
5. Resume execution from safe point
6. Update allocation incrementally
                                </div>
                                <p><strong>Characteristics:</strong></p>
                                <ul style="text-align: left; font-size: 0.9em;">
                                    <li>‚úì Minimal work lost</li>
                                    <li>‚úì Efficient resource use</li>
                                    <li>‚úó Complex implementation</li>
                                    <li>‚úó Requires checkpointing</li>
                                </ul>
                            </div>
                        </div>
                        
                        <h5>üö´ 3. Starvation Prevention</h5>
                        <div class="important-point">
                            <p><strong>Problem:</strong> Same process may always be selected as victim</p>
                            <p><strong>Solutions:</strong></p>
                            <div class="code-block">
Starvation_Prevention_Methods:

1. Rollback Counter Method:
   - Include number of rollbacks in cost function
   - victim_cost += rollback_count[i] * penalty_factor
   - Higher rollback count = higher cost = less likely to be selected

2. Time-based Protection:
   - Processes that haven't been victims recently get protection
   - last_victim_time[i] affects selection probability
   - victim_cost += (current_time - last_victim_time[i]) * time_weight

3. Round-robin Victim Selection:
   - Rotate victim selection among eligible processes
   - Ensure fair distribution of preemption burden
   - victim_index = (victim_index + 1) % eligible_process_count

4. Maximum Rollback Limit:
   - Set maximum number of times a process can be preempted
   - if (rollback_count[i] >= MAX_ROLLBACKS): exclude from selection
   - Force completion or use alternative recovery method
                            </div>
                        </div>
                    </div>
                    
                    <div class="important-point">
                        <h4>üîç Resource Preemption Applicability</h4>
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Resource Type</th>
                                    <th>Preemption Feasibility</th>
                                    <th>Method</th>
                                    <th>Challenges</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>CPU</strong></td>
                                    <td>‚úÖ Easy</td>
                                    <td>Context switching</td>
                                    <td>Minimal - standard in OS</td>
                                </tr>
                                <tr>
                                    <td><strong>Memory</strong></td>
                                    <td>‚úÖ Possible</td>
                                    <td>Swapping to disk</td>
                                    <td>Performance impact</td>
                                </tr>
                                <tr>
                                    <td><strong>Printer</strong></td>
                                    <td>‚ùå Difficult</td>
                                    <td>Restart print job</td>
                                    <td>Paper waste, user confusion</td>
                                </tr>
                                <tr>
                                    <td><strong>Tape Drive</strong></td>
                                    <td>‚ùå Difficult</td>
                                    <td>Rewind and restart</td>
                                    <td>Data consistency issues</td>
                                </tr>
                                <tr>
                                    <td><strong>Database Locks</strong></td>
                                    <td>‚ö†Ô∏è Complex</td>
                                    <td>Transaction rollback</td>
                                    <td>ACID property violations</td>
                                </tr>
                                <tr>
                                    <td><strong>Network Connections</strong></td>
                                    <td>‚ö†Ô∏è Depends</td>
                                    <td>Close and reestablish</td>
                                    <td>Session state loss</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="important">
                    <h4>‚öñÔ∏è Complete Recovery Strategy Comparison</h4>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Strategy</th>
                                <th>Implementation</th>
                                <th>Recovery Time</th>
                                <th>Resource Cost</th>
                                <th>System Impact</th>
                                <th>Best Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Abort All</strong></td>
                                <td>Simple</td>
                                <td>Immediate</td>
                                <td>Very High</td>
                                <td>High</td>
                                <td>Critical system recovery</td>
                            </tr>
                            <tr>
                                <td><strong>Abort One by One</strong></td>
                                <td>Medium</td>
                                <td>Variable</td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>Interactive systems</td>
                            </tr>
                            <tr>
                                <td><strong>Total Preemption</strong></td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>Medium</td>
                                <td>Batch processing</td>
                            </tr>
                            <tr>
                                <td><strong>Partial Preemption</strong></td>
                                <td>Complex</td>
                                <td>Fast</td>
                                <td>Low</td>
                                <td>Low</td>
                                <td>Database systems</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="memory-tip">
                    <p><strong>üí≠ Recovery Memory Technique:</strong> "Kill or Steal" - Either terminate processes (kill) or take away their resources (steal). Choose based on what's easier to restore!</p>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Exam Essentials:</strong> Know the 7 factors for process selection, understand the 3 issues in resource preemption, and be able to compare total vs partial rollback strategies.</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 22: What are the two main approaches to recovery from deadlock?
                        </div>
                        <div class="options" data-question="22">
                            <div class="option" data-answer="correct">A) Process termination and resource preemption</div>
                            <div class="option" data-answer="wrong">B) Process scheduling and memory management</div>
                            <div class="option" data-answer="wrong">C) Prevention and avoidance</div>
                            <div class="option" data-answer="wrong">D) Detection and isolation</div>
                        </div>
                        <div class="result" id="result22"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 23: In resource preemption, the same process should never be selected as victim repeatedly to avoid starvation.
                        </div>
                        <div class="true-false" data-question="23">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result23"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 24: To avoid starvation in resource preemption, include the number of <span class="fill-blank"><input type="text" data-answer="rollbacks" placeholder="?"></span> in the cost factor.
                        </div>
                        <div class="result" id="result24"></div>
                        <button class="quiz-btn" data-check="24">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Methods Comparison Section -->
        <div id="methods-comparison" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Complete Methods Comparison</h2>
                
                <div class="key-concept">
                    <h3>üîÑ Four Approaches to Handle Deadlock</h3>
                    <p class="super-important">Each approach has different trade-offs in terms of performance, complexity, and resource utilization.</p>
                </div>

                <div class="important">
                    <h4>üìä Comprehensive Comparison Table</h4>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Approach</th>
                                <th>When Applied</th>
                                <th>Resource Utilization</th>
                                <th>Runtime Overhead</th>
                                <th>Complexity</th>
                                <th>Practical Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>üõ°Ô∏è Prevention</strong></td>
                                <td>Design time</td>
                                <td>Low to Medium</td>
                                <td>Low</td>
                                <td>Medium</td>
                                <td>Specialized systems</td>
                            </tr>
                            <tr>
                                <td><strong>üéØ Avoidance</strong></td>
                                <td>Runtime (before allocation)</td>
                                <td>Medium to High</td>
                                <td>Medium</td>
                                <td>High</td>
                                <td>Real-time systems</td>
                            </tr>
                            <tr>
                                <td><strong>üîç Detection</strong></td>
                                <td>Runtime (after deadlock)</td>
                                <td>High</td>
                                <td>Low to Medium</td>
                                <td>Medium</td>
                                <td>Database systems</td>
                            </tr>
                            <tr>
                                <td><strong>üôà Ignore</strong></td>
                                <td>Never</td>
                                <td>Highest</td>
                                <td>None</td>
                                <td>Lowest</td>
                                <td>General purpose OS</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="deadlock-conditions">
                    <div class="condition-card">
                        <h4>üõ°Ô∏è Prevention Approach</h4>
                        <div style="text-align: left;">
                            <p><strong>Philosophy:</strong> Ensure at least one necessary condition cannot hold</p>
                            <p><strong>‚úÖ Advantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>No deadlock can ever occur</li>
                                <li>No runtime detection overhead</li>
                                <li>Predictable system behavior</li>
                                <li>Simple to implement</li>
                            </ul>
                            <p><strong>‚ùå Disadvantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Low device utilization</li>
                                <li>Reduced system throughput</li>
                                <li>May prevent useful resource sharing</li>
                                <li>Restricts programming flexibility</li>
                            </ul>
                            <p><strong>üéØ Best for:</strong> Embedded systems, real-time systems with predictable resource needs</p>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üéØ Avoidance Approach</h4>
                        <div style="text-align: left;">
                            <p><strong>Philosophy:</strong> Dynamically examine allocation to ensure safe state</p>
                            <p><strong>‚úÖ Advantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Better resource utilization than prevention</li>
                                <li>No process termination needed</li>
                                <li>Mathematically sound (Banker's algorithm)</li>
                                <li>Guarantees no deadlock</li>
                            </ul>
                            <p><strong>‚ùå Disadvantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Requires maximum resource knowledge</li>
                                <li>Fixed number of processes/resources</li>
                                <li>Conservative (may deny safe requests)</li>
                                <li>High computational overhead</li>
                            </ul>
                            <p><strong>üéØ Best for:</strong> Systems with known resource patterns, academic examples</p>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üîç Detection Approach</h4>
                        <div style="text-align: left;">
                            <p><strong>Philosophy:</strong> Allow deadlock, detect it, then recover</p>
                            <p><strong>‚úÖ Advantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>High resource utilization</li>
                                <li>No advance resource knowledge needed</li>
                                <li>No restrictions on resource requests</li>
                                <li>Flexible system design</li>
                            </ul>
                            <p><strong>‚ùå Disadvantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>Detection algorithm overhead</li>
                                <li>Recovery process complexity</li>
                                <li>Some work may be lost</li>
                                <li>Potential for frequent deadlocks</li>
                            </ul>
                            <p><strong>üéØ Best for:</strong> Database systems, systems where deadlock is rare</p>
                        </div>
                    </div>
                    
                    <div class="condition-card">
                        <h4>üôà Ignore Approach</h4>
                        <div style="text-align: left;">
                            <p><strong>Philosophy:</strong> Assume deadlock will never occur</p>
                            <p><strong>‚úÖ Advantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>No overhead for deadlock handling</li>
                                <li>Maximum resource utilization</li>
                                <li>Simple system design</li>
                                <li>High performance</li>
                            </ul>
                            <p><strong>‚ùå Disadvantages:</strong></p>
                            <ul style="margin: 5px 0 5px 20px;">
                                <li>System may hang if deadlock occurs</li>
                                <li>Manual intervention required</li>
                                <li>Unpredictable system behavior</li>
                                <li>User frustration</li>
                            </ul>
                            <p><strong>üéØ Best for:</strong> Systems where deadlock is very rare (UNIX, Windows)</p>
                        </div>
                    </div>
                </div>

                <div class="algorithm-box">
                    <h4>üè¢ Real-World Usage Examples</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                        <div>
                            <h5><strong>üõ°Ô∏è Prevention Used In:</strong></h5>
                            <ul style="line-height: 1.8;">
                                <li><span class="highlight">Embedded systems</span> - Limited resources, predictable patterns</li>
                                <li><span class="highlight">Real-time systems</span> - Must guarantee timing constraints</li>
                                <li><span class="highlight">Safety-critical systems</span> - Cannot afford deadlock</li>
                                <li><span class="highlight">Simple OS kernels</span> - Resource ordering in kernel</li>
                            </ul>
                            
                            <h5><strong>üîç Detection Used In:</strong></h5>
                            <ul style="line-height: 1.8;">
                                <li><span class="highlight">Database systems</span> - Oracle, SQL Server</li>
                                <li><span class="highlight">Transaction processing</span> - Banking systems</li>
                                <li><span class="highlight">Distributed systems</span> - Distributed databases</li>
                                <li><span class="highlight">Some application servers</span> - J2EE containers</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h5><strong>üéØ Avoidance Used In:</strong></h5>
                            <ul style="line-height: 1.8;">
                                <li><span class="highlight">Academic systems</span> - Teaching examples</li>
                                <li><span class="highlight">Some real-time systems</span> - With known resource patterns</li>
                                <li><span class="highlight">Research prototypes</span> - Experimental OS</li>
                                <li><span class="highlight">Specialized applications</span> - Very controlled environments</li>
                            </ul>
                            
                            <h5><strong>üôà Ignore Used In:</strong></h5>
                            <ul style="line-height: 1.8;">
                                <li><span class="highlight">Windows</span> - General purpose OS</li>
                                <li><span class="highlight">Linux/UNIX</span> - Most mainstream OS</li>
                                <li><span class="highlight">MacOS</span> - Desktop systems</li>
                                <li><span class="highlight">Mobile OS</span> - iOS, Android (mostly)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="important-point">
                    <h4>üìà Performance vs Safety Trade-offs</h4>
                    <div class="deadlock-diagram">
                        <div style="position: relative; width: 100%; height: 400px; background: #f8f9fa; border-radius: 10px; padding: 20px;">
                            <div style="position: absolute; bottom: 20px; left: 20px; right: 20px; height: 2px; background: #28503e;"></div>
                            <div style="position: absolute; bottom: 20px; left: 20px; top: 20px; width: 2px; background: #28503e;"></div>
                            
                            <!-- Y-axis label -->
                            <div style="position: absolute; left: 5px; top: 50%; transform: rotate(-90deg); transform-origin: center;">
                                <strong>Safety Guarantee</strong>
                            </div>
                            
                            <!-- X-axis label -->
                            <div style="position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%);">
                                <strong>Performance & Resource Utilization</strong>
                            </div>
                            
                            <!-- Data points -->
                            <div style="position: absolute; bottom: 80px; left: 100px; width: 80px; height: 80px; background: #ff6b6b; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8em;">Prevention</div>
                            
                            <div style="position: absolute; bottom: 70px; left: 200px; width: 80px; height: 80px; background: #4ecdc4; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8em;">Avoidance</div>
                            
                            <div style="position: absolute; bottom: 50px; left: 350px; width: 80px; height: 80px; background: #45b7d1; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8em;">Detection</div>
                            
                            <div style="position: absolute; bottom: 30px; left: 500px; width: 80px; height: 80px; background: #f39c12; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8em;">Ignore</div>
                        </div>
                        <p style="text-align: center; margin-top: 15px; font-style: italic;">
                            <strong>Key Insight:</strong> There's a fundamental trade-off between safety guarantees and system performance.
                        </p>
                    </div>
                </div>

                <div class="exam-tip">
                    <p><strong>üìù Exam Strategy:</strong> Be able to recommend the best approach for different scenarios. Consider factors like: system type, resource predictability, performance requirements, and deadlock frequency.</p>
                </div>

                <div class="quiz-section">
                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">MCQ</span>
                            Question 25: Which approach provides the highest resource utilization?
                        </div>
                        <div class="options" data-question="25">
                            <div class="option" data-answer="wrong">A) Prevention</div>
                            <div class="option" data-answer="wrong">B) Avoidance</div>
                            <div class="option" data-answer="wrong">C) Detection</div>
                            <div class="option" data-answer="correct">D) Ignore</div>
                        </div>
                        <div class="result" id="result25"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">T/F</span>
                            Question 26: Most modern operating systems like Windows and Linux use the ignore approach for deadlock handling.
                        </div>
                        <div class="true-false" data-question="26">
                            <div class="tf-option tf-true" data-answer="correct">TRUE</div>
                            <div class="tf-option tf-false" data-answer="wrong">FALSE</div>
                        </div>
                        <div class="result" id="result26"></div>
                    </div>

                    <div class="quiz-container">
                        <div class="question">
                            <span class="question-type">FILL</span>
                            Question 27: Database systems typically use the <span class="fill-blank"><input type="text" data-answer="detection" placeholder="?"></span> approach for handling deadlocks.
                        </div>
                        <div class="result" id="result27"></div>
                        <button class="quiz-btn" data-check="27">Check Answer</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comprehensive Quiz Section -->
        <div id="comprehensive-quiz" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Final Comprehensive Exam</h2>
                <div class="important">
                    <h4>üìã Final Exam Instructions:</h4>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li><strong>30 comprehensive questions</strong> covering all deadlock topics</li>
                        <li><strong>Mix of question types:</strong> Multiple choice, true/false, and fill-in-the-blank</li>
                        <li><strong>Time limit:</strong> Take your time to read each question carefully</li>
                        <li><strong>Scoring:</strong> Each question is worth equal points</li>
                        <li><strong>Review available:</strong> Detailed explanations provided after completion</li>
                        <li><strong>Retake option:</strong> You can retake the exam to improve your score</li>
                    </ul>
                    
                    <div style="background: #e8f4fd; padding: 15px; border-radius: 10px; margin: 15px 0; border: 2px solid #2196f3;">
                        <p><strong>üìö Topics Covered:</strong></p>
                        <ul style="margin: 10px 0; padding-left: 20px; line-height: 1.8;">
                            <li>Deadlock definition and real-world examples</li>
                            <li>Four necessary conditions for deadlock</li>
                            <li>Resource allocation graphs and cycle detection</li>
                            <li>Prevention methods and their trade-offs</li>
                            <li>Avoidance strategies and Banker's algorithm</li>
                            <li>Detection algorithms for single and multiple instances</li>
                            <li>Recovery strategies: termination and preemption</li>
                            <li>Comparison of all handling approaches</li>
                        </ul>
                    </div>
                </div>

                <div id="comprehensive-quiz-content"></div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="quiz-btn" id="start-final-btn" style="font-size: 1.2em; padding: 20px 40px;">üéØ Start Final Exam</button>
                    <button class="quiz-btn" id="check-final-btn" style="display: none; font-size: 1.2em; padding: 20px 40px;">üìä Submit Exam</button>
                    <button class="quiz-btn" id="reset-final-btn" style="display: none; font-size: 1.2em; padding: 20px 40px;">üîÑ Retake Exam</button>
                </div>

                <div id="final-results" style="display: none;"></div>
            </div>
        </div>

        <!-- Final Summary Section -->
        <div id="final-summary" class="section">
            <div class="topic-card">
                <h2 class="topic-title">Final Summary & Study Guide</h2>
                
                <div class="summary-box">
                    <h3>üîë Complete Deadlock Study Guide</h3>
                    
                    <div class="key-points">
                        <h4>üìö Core Definitions - Must Know:</h4>
                        <ul>
                            <li><span class="super-important">Deadlock:</span> Set of blocked processes each holding a resource and waiting to acquire a resource held by another process in the set</li>
                            <li><span class="super-important">Four Necessary Conditions:</span> Mutual Exclusion, Hold & Wait, No Preemption, Circular Wait (ALL must be present)</li>
                            <li><span class="super-important">Resource Allocation Graph:</span> Directed graph for representing and analyzing resource allocation state</li>
                            <li><span class="super-important">Safe State:</span> System can guarantee completion of all processes in some order</li>
                            <li><span class="super-important">Wait-for Graph:</span> Simplified graph showing only process dependencies (for single-instance resources)</li>
                        </ul>
                    </div>
                    
                    <div class="key-points">
                        <h4>üõ°Ô∏è Handling Methods - Complete Overview:</h4>
                        <ul>
                            <li><span class="highlight">Prevention:</span> Ensure one of the four conditions cannot hold (low utilization)</li>
                            <li><span class="highlight">Avoidance:</span> Use additional information to maintain safe states (Banker's algorithm)</li>
                            <li><span class="highlight">Detection:</span> Allow deadlock, then detect and recover (flexible but costly recovery)</li>
                            <li><span class="highlight">Ignore:</span> Assume deadlock never occurs (used by most modern OS)</li>
                        </ul>
                    </div>

                    <div class="key-points">
                        <h4>üîß Recovery Methods - Key Points:</h4>
                        <ul>
                            <li><span class="highlight">Process Termination:</span> Abort all deadlocked processes OR abort one at a time</li>
                            <li><span class="highlight">Resource Preemption:</span> Select victim, rollback (total/partial), avoid starvation</li>
                            <li><span class="highlight">Selection Criteria:</span> Priority, computation time, resources used/needed, process type</li>
                        </ul>
                    </div>
                </div>

                <div class="important">
                    <h4>üìä Master Comparison Table - Final Review</h4>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>When Applied</th>
                                <th>Deadlock Guarantee</th>
                                <th>Resource Utilization</th>
                                <th>Runtime Overhead</th>
                                <th>Real-World Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Prevention</strong></td>
                                <td>Design time</td>
                                <td>100% (No deadlock ever)</td>
                                <td>Low to Medium</td>
                                <td>None</td>
                                <td>Embedded, Real-time systems</td>
                            </tr>
                            <tr>
                                <td><strong>Avoidance</strong></td>
                                <td>Before allocation</td>
                                <td>100% (Safe states only)</td>
                                <td>Medium</td>
                                <td>Medium to High</td>
                                <td>Academic, Some real-time</td>
                            </tr>
                            <tr>
                                <td><strong>Detection</strong></td>
                                <td>After deadlock occurs</td>
                                <td>0% (Allows deadlock)</td>
                                <td>High</td>
                                <td>Low to Medium</td>
                                <td>Database systems</td>
                            </tr>
                            <tr>
                                <td><strong>Ignore</strong></td>
                                <td>Never</td>
                                <td>0% (No handling)</td>
                                <td>Highest</td>
                                <td>None</td>
                                <td>Windows, Linux, MacOS</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="exam-tip">
                    <h4>üìù Ultimate Exam Preparation Tips:</h4>
                    <div class="key-points">
                        <ul>
                            <li><span class="super-important">Memorize the four conditions:</span> MHNC - Mutual exclusion, Hold and wait, No preemption, Circular wait</li>
                            <li><span class="super-important">Resource Allocation Graph rules:</span> No cycle = No deadlock, Cycle + Single instance = Deadlock, Cycle + Multiple instances = Maybe deadlock</li>
                            <li><span class="super-important">Safe vs Unsafe:</span> Safe State ‚â† No Deadlock, Unsafe State ‚â† Deadlock (but unsafe can lead to deadlock)</li>
                            <li><span class="super-important">Banker's Algorithm components:</span> Available, Max, Allocation, Need (Need = Max - Allocation)</li>
                            <li><span class="super-important">Wait-for Graph:</span> Used only for single-instance resources, nodes are processes only</li>
                            <li><span class="super-important">Recovery factors:</span> Priority, Progress, Resources used/needed, Process type, Previous terminations</li>
                            <li><span class="super-important">Prevention practicality:</span> Circular wait prevention is most practical</li>
                            <li><span class="super-important">Real-world usage:</span> Most modern OS use ignore approach (UNIX, Windows, Linux)</li>
                        </ul>
                    </div>
                </div>

                <div class="memory-tip">
                    <h4>üß† Ultimate Memory Palace for Deadlocks:</h4>
                    <div class="deadlock-diagram">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin: 25px 0;">
                            <div style="background: #e8f5e8; padding: 20px; border-radius: 15px; border: 3px solid #4caf50;">
                                <h5 style="color: #2e7d32; text-align: center; margin-bottom: 15px;">üîí Deadlock Conditions</h5>
                                <div style="text-align: center; line-height: 2;">
                                    <div><strong>M</strong>utual Exclusion</div>
                                    <div><strong>H</strong>old and Wait</div>
                                    <div><strong>N</strong>o Preemption</div>
                                    <div><strong>C</strong>ircular Wait</div>
                                </div>
                                <p style="text-align: center; margin-top: 15px; font-style: italic;">"Must Have No Cycles"</p>
                            </div>
                            
                            <div style="background: #e3f2fd; padding: 20px; border-radius: 15px; border: 3px solid #2196f3;">
                                <h5 style="color: #1976d2; text-align: center; margin-bottom: 15px;">üõ°Ô∏è Handling Methods</h5>
                                <div style="text-align: center; line-height: 2;">
                                    <div><strong>P</strong>revention</div>
                                    <div><strong>A</strong>voidance</div>
                                    <div><strong>D</strong>etection</div>
                                    <div><strong>I</strong>gnore</div>
                                </div>
                                <p style="text-align: center; margin-top: 15px; font-style: italic;">"Please Avoid Dangerous Ideas"</p>
                            </div>
                            
                            <div style="background: #fff3e0; padding: 20px; border-radius: 15px; border: 3px solid #ff9800;">
                                <h5 style="color: #f57c00; text-align: center; margin-bottom: 15px;">üîß Recovery Methods</h5>
                                <div style="text-align: center; line-height: 2;">
                                    <div><strong>T</strong>ermination</div>
                                    <div><strong>P</strong>reemption</div>
                                </div>
                                <p style="text-align: center; margin-top: 15px; font-style: italic;">"Kill or Steal"</p>
                            </div>
                            
                            <div style="background: #f3e5f5; padding: 20px; border-radius: 15px; border: 3px solid #9c27b0;">
                                <h5 style="color: #7b1fa2; text-align: center; margin-bottom: 15px;">üìä Key Algorithms</h5>
                                <div style="text-align: center; line-height: 2;">
                                    <div><strong>B</strong>anker's Algorithm</div>
                                    <div><strong>W</strong>ait-for Graph</div>
                                    <div><strong>S</strong>afety Algorithm</div>
                                    <div><strong>C</strong>ycle Detection</div>
                                </div>
                                <p style="text-align: center; margin-top: 15px; font-style: italic;">"Be Wise, Stay Careful"</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #28503e 0%, #deddeb 100%); border-radius: 20px; color: white; position: relative; overflow: hidden;">
                    <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); animation: rotate 30s linear infinite;"></div>
                    <div style="position: relative; z-index: 1;">
                        <h2 style="font-size: 2.2em; margin-bottom: 15px;">üåü Congratulations! üåü</h2>
                        <h3 style="font-size: 1.5em; margin-bottom: 20px;">You've Mastered Deadlock Concepts!</h3>
                        <p style="font-size: 1.2em; margin-bottom: 15px;">You are now ready to tackle any deadlock problem in your Operating Systems exam!</p>
                        <div style="display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap;">
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; backdrop-filter: blur(10px);">
                                <div style="font-size: 1.5em; font-weight: bold;">‚úÖ</div>
                                <div>Prevention</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; backdrop-filter: blur(10px);">
                                <div style="font-size: 1.5em; font-weight: bold;">üéØ</div>
                                <div>Avoidance</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; backdrop-filter: blur(10px);">
                                <div style="font-size: 1.5em; font-weight: bold;">üîç</div>
                                <div>Detection</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; backdrop-filter: blur(10px);">
                                <div style="font-size: 1.5em; font-weight: bold;">üîß</div>
                                <div>Recovery</div>
                            </div>
                        </div>
                        <p style="font-size: 1em; margin-top: 25px; opacity: 0.9; font-style: italic;">
                            "Remember: Prevention is better than cure, but detection and recovery is sometimes more practical!"
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let totalScore = 0;
        let totalQuestions = 0;
        let comprehensiveQuizQuestions = [];
        let comprehensiveAnswers = {};
        let sectionProgress = {};
        let achievements = [];

        function showSection(sectionId, buttonElement) {
            try {
                // Hide all sections
                const sections = document.querySelectorAll('.section');
                sections.forEach(section => section.classList.remove('active'));
                
                // Show selected section
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
                
                // Update navigation
                const buttons = document.querySelectorAll('.nav-btn');
                buttons.forEach(btn => btn.classList.remove('active'));
                
                if (buttonElement && buttonElement.classList.contains('nav-btn')) {
                    buttonElement.classList.add('active');
                }
                
                // Update progress
                updateProgress();
                updateSectionProgress(sectionId);
            } catch (error) {
                console.error('Error in showSection:', error);
            }
        }

        function updateProgress() {
            try {
                const progress = (totalScore / Math.max(totalQuestions, 1)) * 100;
                const progressBar = document.getElementById('progress');
                const scoreDisplay = document.getElementById('scoreDisplay');
                const percentageDisplay = document.getElementById('percentageDisplay');
                
                if (progressBar) progressBar.style.width = progress + '%';
                if (scoreDisplay) scoreDisplay.textContent = `Score: ${totalScore}/${totalQuestions}`;
                if (percentageDisplay) percentageDisplay.textContent = `${progress.toFixed(1)}%`;
                
                // Update stats
                const totalQuestionsEl = document.getElementById('totalQuestions');
                const correctAnswersEl = document.getElementById('correctAnswers');
                const accuracyEl = document.getElementById('accuracy');
                
                if (totalQuestionsEl) totalQuestionsEl.textContent = totalQuestions;
                if (correctAnswersEl) correctAnswersEl.textContent = totalScore;
                if (accuracyEl) accuracyEl.textContent = `${progress.toFixed(1)}%`;
                
                // Check for achievements
                checkAchievements(progress);
            } catch (error) {
                console.error('Error in updateProgress:', error);
            }
        }

        function updateSectionProgress(sectionId) {
            try {
                if (!sectionProgress[sectionId]) {
                    sectionProgress[sectionId] = true;
                    const completed = Object.keys(sectionProgress).length;
                    const sectionsCompletedEl = document.getElementById('sectionsCompleted');
                    if (sectionsCompletedEl) {
                        sectionsCompletedEl.textContent = completed;
                    }
                }
            } catch (error) {
                console.error('Error in updateSectionProgress:', error);
            }
        }

        function checkAchievements(progress) {
            try {
                const achievementElements = document.querySelectorAll('.achievement');
                achievementElements.forEach(achievement => {
                    const unlockScore = parseInt(achievement.dataset.unlock);
                    if (totalScore >= unlockScore && !achievement.classList.contains('unlocked')) {
                        achievement.classList.add('unlocked');
                        achievements.push(unlockScore);
                    }
                });
            } catch (error) {
                console.error('Error in checkAchievements:', error);
            }
        }

        function toggleCollapsible(element) {
            element.classList.toggle('active');
        }

        // Enhanced Quiz functionality
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('option')) {
                handleMCQAnswer(e);
            } else if (e.target.classList.contains('tf-option')) {
                handleTrueFalseAnswer(e);
            }
        });

        function handleMCQAnswer(e) {
            const optionsContainer = e.target.closest('.options');
            if (!optionsContainer) return;
            
            const question = optionsContainer.dataset.question;
            const options = optionsContainer.querySelectorAll('.option');
            const result = document.getElementById('result' + question);
            
            if (!result) return;
            
            // Remove previous selections
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Mark selected option
            e.target.classList.add('selected');
            
            // Check answer
            const isCorrect = e.target.dataset.answer === 'correct';
            e.target.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            // Show result
            showResult(result, isCorrect, question);
            
            // Show correct answer if wrong
            if (!isCorrect) {
                options.forEach(opt => {
                    if (opt.dataset.answer === 'correct') {
                        opt.classList.add('correct');
                    }
                });
            }
        }

        function handleTrueFalseAnswer(e) {
            const tfContainer = e.target.closest('.true-false');
            if (!tfContainer) return;
            
            const question = tfContainer.dataset.question;
            const options = tfContainer.querySelectorAll('.tf-option');
            const result = document.getElementById('result' + question);
            
            if (!result) return;
            
            // Remove previous selections
            options.forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Mark selected option
            e.target.classList.add('selected');
            
            // Check answer
            const isCorrect = e.target.dataset.answer === 'correct';
            
            // Show result
            showResult(result, isCorrect, question);
        }

        function showResult(resultElement, isCorrect, questionNumber) {
            if (!resultElement) return;
            
            resultElement.style.display = 'block';
            resultElement.className = 'result ' + (isCorrect ? 'correct' : 'incorrect');
            
            // Add show class with a small delay for animation
            setTimeout(() => {
                resultElement.classList.add('show');
            }, 10);
            
            const messages = {
                correct: [
                    '‚úÖ Excellent! Perfect answer!',
                    'üéâ Outstanding! You got it right!',
                    '‚≠ê Brilliant! Correct answer!',
                    'üöÄ Fantastic! Well done!',
                    'üíØ Perfect! You understand this concept!',
                    'üèÜ Superb! Great job!'
                ],
                incorrect: [
                    '‚ùå Not quite right. Review the explanation above.',
                    'ü§î Incorrect. Check the key concepts again.',
                    'üìö Wrong answer. Study this topic more carefully.',
                    'üí° Not correct. Look at the detailed explanation.',
                    'üîç Incorrect. Review the material and try again.',
                    'üìñ Wrong. Go back to the content for clarification.'
                ]
            };
            
            const messageArray = isCorrect ? messages.correct : messages.incorrect;
            const randomMessage = messageArray[Math.floor(Math.random() * messageArray.length)];
            resultElement.textContent = randomMessage;
            
            // Update score if not answered before
            const container = resultElement.closest('.quiz-container');
            if (container && !container.dataset.answered) {
                totalQuestions++;
                if (isCorrect) totalScore++;
                container.dataset.answered = 'true';
                updateProgress();
            }
        }

        function checkFillBlank(questionNumber) {
            const questionContainer = document.getElementById('result' + questionNumber);
            if (!questionContainer) return;
            
            const parentContainer = questionContainer.closest('.quiz-container');
            if (!parentContainer) return;
            
            const input = parentContainer.querySelector('input[data-answer]');
            if (!input) return;
            
            const userAnswer = input.value.toLowerCase().trim();
            const correctAnswer = input.dataset.answer.toLowerCase();
            const result = document.getElementById('result' + questionNumber);
            
            const isCorrect = userAnswer === correctAnswer;
            
            // Visual feedback
            input.style.borderColor = isCorrect ? '#4caf50' : '#f44336';
            input.style.backgroundColor = isCorrect ? '#e8f5e8' : '#ffebee';
            
            showResult(result, isCorrect, questionNumber);
            
            if (!isCorrect) {
                setTimeout(() => {
                    input.value = correctAnswer;
                    input.style.borderColor = '#4caf50';
                    input.style.backgroundColor = '#e8f5e8';
                }, 2000);
            }
        }

        // Comprehensive Final Exam
        function generateFinalExam() {
            const questions = [
                {
                    type: 'mcq',
                    question: "What is the most accurate definition of deadlock?",
                    options: [
                        "A process that runs very slowly due to resource contention",
                        "A set of blocked processes each holding a resource and waiting for another",
                        "When the system runs out of available memory",
                        "A scheduling algorithm that causes process starvation"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "All four necessary conditions must hold simultaneously for deadlock to occur.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "Which condition means 'only one process can use a resource at a time'?",
                    options: ["Hold and Wait", "Mutual Exclusion", "No Preemption", "Circular Wait"],
                    correct: 1
                },
                {
                    type: 'mcq',
                    question: "In a resource allocation graph, what does a request edge represent?",
                    options: [
                        "A resource allocated to a process",
                        "A process requesting a resource", 
                        "A process releasing a resource",
                        "A resource type definition"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "If a resource allocation graph contains no cycles, then there is no deadlock.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "If a cycle exists and each resource type has only one instance, what can we conclude?",
                    options: ["No deadlock", "Possibility of deadlock", "Deadlock definitely exists", "Cannot determine"],
                    correct: 2
                },
                {
                    type: 'mcq',
                    question: "Which deadlock prevention approach is generally most practical?",
                    options: [
                        "Preventing mutual exclusion",
                        "Preventing hold and wait", 
                        "Allowing preemption",
                        "Preventing circular wait"
                    ],
                    correct: 3
                },
                {
                    type: 'tf',
                    question: "To prevent hold and wait, a process must request all resources before beginning execution.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "What information is required for deadlock avoidance using Banker's algorithm?",
                    options: [
                        "Process priorities and execution times",
                        "Maximum resource requirements of each process",
                        "Current CPU utilization only", 
                        "Process memory requirements only"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "A safe state guarantees that no deadlock can occur.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "In Banker's algorithm, what does the Need matrix represent?",
                    options: [
                        "Currently allocated resources to each process",
                        "Maximum resource requirements of each process",
                        "Available resources in the system", 
                        "Remaining resource needs of each process"
                    ],
                    correct: 3
                },
                {
                    type: 'tf',
                    question: "An unsafe state necessarily leads to deadlock.",
                    correct: false
                },
                {
                    type: 'mcq',
                    question: "In a wait-for graph, what do the nodes represent?",
                    options: ["Resources only", "Processes only", "Both processes and resources", "System states"],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "The complexity of cycle detection in a wait-for graph is O(n¬≤).",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "What are the two main approaches to recovery from deadlock?",
                    options: [
                        "Prevention and avoidance",
                        "Process termination and resource preemption",
                        "Detection and isolation",
                        "Scheduling and memory management"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "In resource preemption, the same process should never be selected as victim repeatedly to avoid starvation.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "Which factor is NOT typically considered when selecting a process for termination?",
                    options: [
                        "Priority of the process",
                        "Resources the process has used",
                        "Process creation time",
                        "Whether process is interactive or batch"
                    ],
                    correct: 2
                },
                {
                    type: 'mcq',
                    question: "What happens when we convert a resource allocation graph to a wait-for graph?",
                    options: [
                        "We add more process nodes", 
                        "We remove resource nodes and connect processes directly",
                        "We add more resource edges",
                        "Nothing changes in the graph structure"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "Most operating systems, including UNIX and Windows, use the ignore approach to handle deadlocks.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "In circular wait prevention, what do we impose on resource types?",
                    options: ["Random ordering", "Total ordering", "Partial ordering", "No ordering"],
                    correct: 1
                },
                {
                    type: 'mcq',
                    question: "What is the main disadvantage of deadlock prevention?",
                    options: [
                        "Very high computational complexity",
                        "Requires future knowledge of resource needs",
                        "Low resource utilization and reduced throughput",
                        "Cannot detect deadlocks when they occur"
                    ],
                    correct: 2
                },
                {
                    type: 'tf',
                    question: "Resource preemption can only be applied to certain types of resources that can be safely interrupted.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "In Banker's algorithm, if we cannot find a safe sequence, what does this mean?",
                    options: [
                        "System is in safe state",
                        "System is in unsafe state", 
                        "Deadlock definitely exists right now",
                        "More resources are needed immediately"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "Starvation is a potential problem in both deadlock prevention and recovery mechanisms.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "Which approach provides the highest resource utilization?",
                    options: ["Prevention", "Avoidance", "Detection", "Ignore"],
                    correct: 3
                },
                {
                    type: 'mcq',
                    question: "In the dining philosophers problem, deadlock occurs when:",
                    options: [
                        "One philosopher eats too slowly",
                        "All philosophers pick up their left chopstick simultaneously",
                        "Philosophers eat in a specific order",
                        "There are more philosophers than chopsticks"
                    ],
                    correct: 1
                },
                {
                    type: 'tf',
                    question: "Database systems typically use detection and recovery for deadlock handling.",
                    correct: true
                },
                {
                    type: 'mcq',
                    question: "Which rollback strategy in resource preemption is more efficient but complex to implement?",
                    options: [
                        "Total rollback (restart from beginning)",
                        "Partial rollback (return to safe checkpoint)",
                        "No rollback (terminate process)",
                        "Random rollback (choose arbitrary point)"
                    ],
                    correct: 1
                },
                {
                    type: 'mcq',
                    question: "What is the relationship between safe states and deadlock?",
                    options: [
                        "Safe state guarantees deadlock will occur",
                        "Unsafe state means deadlock exists",
                        "Safe state guarantees no deadlock can occur",
                        "There is no relationship between them"
                    ],
                    correct: 2
                },
                {
                    type: 'mcq',
                    question: "When should deadlock detection algorithm be invoked for optimal performance?",
                    options: [
                        "Every time any process makes a request",
                        "Only when CPU utilization drops below threshold",
                        "Never, as it's too expensive",
                        "Based on system load and request patterns"
                    ],
                    correct: 3
                }
            ];

            comprehensiveQuizQuestions = [...questions];
            comprehensiveAnswers = {};
            
            const quizContainer = document.getElementById('comprehensive-quiz-content');
            quizContainer.innerHTML = '';
            
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-container';
                
                let questionHTML = `<div class="question">
                    <span class="question-type">${q.type.toUpperCase()}</span>
                    Question ${index + 1}: ${q.question}
                </div>`;
                
                if (q.type === 'mcq') {
                    questionHTML += `<div class="options" data-question="final-${index}">
                        ${q.options.map((option, optIndex) => 
                            `<div class="option" data-answer="${optIndex}" onclick="selectFinalAnswer(${index}, ${optIndex}, 'mcq')">${String.fromCharCode(65 + optIndex)}) ${option}</div>`
                        ).join('')}
                    </div>`;
                } else if (q.type === 'tf') {
                    questionHTML += `<div class="true-false" data-question="final-${index}">
                        <div class="tf-option tf-true" data-answer="true" onclick="selectFinalAnswer(${index}, true, 'tf')">TRUE</div>
                        <div class="tf-option tf-false" data-answer="false" onclick="selectFinalAnswer(${index}, false, 'tf')">FALSE</div>
                    </div>`;
                }
                
                questionHTML += `<div class="result" id="final-result${index}"></div>`;
                questionDiv.innerHTML = questionHTML;
                quizContainer.appendChild(questionDiv);
            });
            
            document.getElementById('start-final-btn').style.display = 'none';
            document.getElementById('check-final-btn').style.display = 'inline-block';
        }

        function selectFinalAnswer(questionIndex, answer, type) {
            comprehensiveAnswers[questionIndex] = {answer: answer, type: type};
            
            // Visual feedback
            if (type === 'mcq') {
                const options = document.querySelectorAll(`[data-question="final-${questionIndex}"] .option`);
                options.forEach(opt => opt.classList.remove('selected'));
                if (options[answer]) {
                    options[answer].classList.add('selected');
                }
            } else if (type === 'tf') {
                const options = document.querySelectorAll(`[data-question="final-${questionIndex}"] .tf-option`);
                options.forEach(opt => opt.classList.remove('selected'));
                
                // Find and select the clicked option
                const clickedOption = document.querySelector(`[data-question="final-${questionIndex}"] .tf-option[data-answer="${answer}"]`);
                if (clickedOption) {
                    clickedOption.classList.add('selected');
                }
            }
        }

        function checkFinalExam() {
            let score = 0;
            const results = [];
            
            comprehensiveQuizQuestions.forEach((q, index) => {
                const userAnswerObj = comprehensiveAnswers[index];
                let isCorrect = false;
                let userAnswer = 'Not answered';
                
                if (q.type === 'mcq' && userAnswerObj) {
                    isCorrect = userAnswerObj.answer === q.correct;
                    userAnswer = q.options[userAnswerObj.answer] || 'Not answered';
                } else if (q.type === 'tf' && userAnswerObj) {
                    isCorrect = userAnswerObj.answer === q.correct;
                    userAnswer = userAnswerObj.answer ? 'TRUE' : 'FALSE';
                }
                
                if (isCorrect) score++;
                
                results.push({
                    question: q.question,
                    userAnswer: userAnswer,
                    correctAnswer: q.type === 'mcq' ? q.options[q.correct] : (q.correct ? 'TRUE' : 'FALSE'),
                    isCorrect: isCorrect,
                    type: q.type
                });
            });
            
            displayFinalResults(score, results);
        }

        function displayFinalResults(score, results) {
            const percentage = (score / comprehensiveQuizQuestions.length * 100).toFixed(1);
            let grade = '';
            let gradeColor = '';
            let feedback = '';
            
            if (percentage >= 95) { 
                grade = 'A+ Outstanding'; 
                gradeColor = '#4caf50'; 
                feedback = 'üéØ Perfect! You have mastered deadlock concepts completely!';
            }
            else if (percentage >= 90) { 
                grade = 'A Excellent'; 
                gradeColor = '#4caf50'; 
                feedback = 'üåü Excellent work! You have a deep understanding of deadlocks!';
            }
            else if (percentage >= 80) { 
                grade = 'B+ Very Good'; 
                gradeColor = '#8bc34a'; 
                feedback = 'üëè Very good! You understand most deadlock concepts well!';
            }
            else if (percentage >= 70) { 
                grade = 'B Good'; 
                gradeColor = '#ffc107'; 
                feedback = 'üìö Good understanding! Review some concepts and you\'ll be ready!';
            }
            else if (percentage >= 60) { 
                grade = 'C+ Satisfactory'; 
                gradeColor = '#ff9800'; 
                feedback = 'üìñ You\'re on the right track! More study needed for mastery.';
            }
            else { 
                grade = 'C Needs Improvement'; 
                gradeColor = '#f44336'; 
                feedback = 'üîÑ Keep studying! Review all sections and retake the exam.';
            }
            
            const resultsDiv = document.getElementById('final-results');
            resultsDiv.innerHTML = `
                <div class="summary-box">
                    <h3>üéØ Final Exam Results</h3>
                    <div style="text-align: center; margin: 25px 0;">
                        <div style="font-size: 3.5em; color: ${gradeColor}; margin-bottom: 15px; font-weight: bold;">
                            ${score}/${comprehensiveQuizQuestions.length}
                        </div>
                        <div style="font-size: 2.5em; margin: 15px 0; color: ${gradeColor}; font-weight: bold;">
                            ${percentage}%
                        </div>
                        <div style="font-size: 1.8em; margin: 15px 0; color: ${gradeColor}; font-weight: bold;">
                            Grade: ${grade}
                        </div>
                        <div style="font-size: 1.2em; margin: 20px 0; padding: 15px; background: rgba(${gradeColor === '#4caf50' ? '76, 175, 80' : gradeColor === '#8bc34a' ? '139, 195, 74' : gradeColor === '#ffc107' ? '255, 193, 7' : gradeColor === '#ff9800' ? '255, 152, 0' : '244, 67, 54'}, 0.1); border-radius: 10px;">
                            ${feedback}
                        </div>
                    </div>
                    
                    <div class="key-points">
                        <h4>üìã Detailed Review (Click to expand sections):</h4>
                        <div style="max-height: 500px; overflow-y: auto; margin-top: 15px;">
                            ${results.map((result, index) => `
                                <div style="margin: 12px 0; padding: 18px; border-radius: 12px; background: ${result.isCorrect ? '#e8f5e8' : '#ffebee'}; border-left: 5px solid ${result.isCorrect ? '#4caf50' : '#f44336'}; transition: all 0.3s ease; cursor: pointer;" onclick="this.querySelector('.details').style.display = this.querySelector('.details').style.display === 'none' ? 'block' : 'none'">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <strong>Q${index + 1} [${result.type.toUpperCase()}]</strong>
                                        <span style="font-size: 1.4em;">${result.isCorrect ? '‚úÖ' : '‚ùå'}</span>
                                    </div>
                                    <div class="details" style="display: none; margin-top: 10px;">
                                        <div style="margin: 8px 0;"><strong>Question:</strong> ${result.question}</div>
                                        <div style="margin: 8px 0;"><strong>Your Answer:</strong> ${result.userAnswer}</div>
                                        <div style="margin: 8px 0;"><strong>Correct Answer:</strong> ${result.correctAnswer}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    ${percentage >= 70 ? `
                        <div class="key-points" style="background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%); border: 3px solid #4caf50;">
                            <h4>üéâ Congratulations!</h4>
                            <p style="font-size: 1.1em; line-height: 1.6;">You have demonstrated excellent understanding of deadlock concepts! You're well prepared for your Operating Systems exam. Key areas you've mastered:</p>
                            <ul style="margin-top: 15px; line-height: 1.8;">
                                <li>‚úÖ Deadlock definition and necessary conditions</li>
                                <li>‚úÖ Resource allocation graphs and cycle detection</li>
                                <li>‚úÖ Prevention, avoidance, detection, and recovery strategies</li>
                                <li>‚úÖ Banker's algorithm and safety checking</li>
                                <li>‚úÖ Practical applications and trade-offs</li>
                            </ul>
                        </div>
                    ` : `
                        <div class="important">
                            <h4>üìö Study Recommendations for Improvement:</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px;">
                                <div style="background: #fff3cd; padding: 15px; border-radius: 10px; border: 2px solid #ffc107;">
                                    <h5 style="color: #8a6914;">üîë Core Concepts</h5>
                                    <ul style="margin-top: 10px; font-size: 0.9em;">
                                        <li>Review the four necessary conditions</li>
                                        <li>Practice identifying deadlock scenarios</li>
                                        <li>Understand resource allocation graphs</li>
                                    </ul>
                                </div>
                                <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; border: 2px solid #2196f3;">
                                    <h5 style="color: #1565c0;">üõ°Ô∏è Handling Methods</h5>
                                    <ul style="margin-top: 10px; font-size: 0.9em;">
                                        <li>Study prevention techniques</li>
                                        <li>Master Banker's algorithm</li>
                                        <li>Learn detection algorithms</li>
                                    </ul>
                                </div>
                                <div style="background: #f3e5f5; padding: 15px; border-radius: 10px; border: 2px solid #9c27b0;">
                                    <h5 style="color: #6a1b9a;">üîß Recovery Strategies</h5>
                                    <ul style="margin-top: 10px; font-size: 0.9em;">
                                        <li>Understand process termination</li>
                                        <li>Learn resource preemption</li>
                                        <li>Study victim selection criteria</li>
                                    </ul>
                                </div>
                            </div>
                            <div style="text-align: center; margin-top: 20px; padding: 15px; background: #e8f4fd; border-radius: 10px;">
                                <strong>üí° Recommendation:</strong> Review the sections where you missed questions, then retake the exam to improve your score!
                            </div>
                        </div>
                    `}
                </div>
            `;
            resultsDiv.style.display = 'block';
            
            document.getElementById('check-final-btn').style.display = 'none';
            document.getElementById('reset-final-btn').style.display = 'inline-block';
            
            // Update overall progress
            totalScore += score;
            totalQuestions += comprehensiveQuizQuestions.length;
            updateProgress();
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function resetFinalExam() {
            document.getElementById('comprehensive-quiz-content').innerHTML = '';
            document.getElementById('final-results').style.display = 'none';
            document.getElementById('start-final-btn').style.display = 'inline-block';
            document.getElementById('check-final-btn').style.display = 'none';
            document.getElementById('reset-final-btn').style.display = 'none';
            comprehensiveAnswers = {};
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            try {
                updateProgress();
                console.log('üîí Complete Interactive Deadlock Guide Loaded Successfully!');
                console.log('üéØ Complete all quizzes to master deadlock concepts!');
                
                // Add click handlers for navigation
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        const sectionId = this.getAttribute('data-section');
                        if (sectionId) {
                            showSection(sectionId, this);
                        }
                    });
                });
                
                // Add click handlers for fill-in-the-blank check buttons
                document.querySelectorAll('.quiz-btn[data-check]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const questionNumber = this.getAttribute('data-check');
                        if (questionNumber) {
                            checkFillBlank(questionNumber);
                        }
                    });
                });
                
                // Add click handlers for final exam buttons
                const startFinalBtn = document.getElementById('start-final-btn');
                const checkFinalBtn = document.getElementById('check-final-btn');
                const resetFinalBtn = document.getElementById('reset-final-btn');
                
                if (startFinalBtn) {
                    startFinalBtn.addEventListener('click', generateFinalExam);
                }
                if (checkFinalBtn) {
                    checkFinalBtn.addEventListener('click', checkFinalExam);
                }
                if (resetFinalBtn) {
                    resetFinalBtn.addEventListener('click', resetFinalExam);
                }
                
            } catch (error) {
                console.error('Error initializing page:', error);
            }
        });

        // Enhanced keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Arrow key navigation
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                const activeBtn = document.querySelector('.nav-btn.active');
                if (activeBtn) {
                    const buttons = Array.from(document.querySelectorAll('.nav-btn'));
                    const currentIndex = buttons.indexOf(activeBtn);
                    let newIndex;
                    
                    if (e.key === 'ArrowLeft') {
                        newIndex = currentIndex > 0 ? currentIndex - 1 : buttons.length - 1;
                    } else {
                        newIndex = currentIndex < buttons.length - 1 ? currentIndex + 1 : 0;
                    }
                    
                    const targetBtn = buttons[newIndex];
                    if (targetBtn) {
                        targetBtn.click();
                    }
                }
            }
            
            // Quick shortcuts
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case '1':
                        e.preventDefault();
                        document.querySelector('[data-section="overview"]').click();
                        break;
                    case '2':
                        e.preventDefault();
                        document.querySelector('[data-section="deadlock-problem"]').click();
                        break;
                    case '3':
                        e.preventDefault();
                        document.querySelector('[data-section="characterization"]').click();
                        break;
                    case '0':
                        e.preventDefault();
                        document.querySelector('[data-section="final-summary"]').click();
                        break;
                }
            }
        });

        // Add smooth scrolling for better UX
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add loading animation for better perceived performance
        window.addEventListener('load', function() {
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s ease-in-out';
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>
